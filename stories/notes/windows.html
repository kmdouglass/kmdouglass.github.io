<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Notes I've collected for doing things in Windows">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Windows notes | Kyle M. Douglass</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://kmdouglass.github.io/stories/notes/windows.html">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
    }
});
</script><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta name="description" itemprop="description" content="Notes I've collected for doing things in Windows">
<meta name="author" content="Kyle M. Douglass">
<meta property="og:site_name" content="Kyle M. Douglass">
<meta property="og:title" content="Windows notes">
<meta property="og:url" content="http://kmdouglass.github.io/stories/notes/windows.html">
<meta property="og:description" content="Notes I've collected for doing things in Windows">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2014-12-26T00:00:00+01:00">
<meta property="article:tag" content="windows">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://kmdouglass.github.io/">

                <span id="blog-title">Kyle M. Douglass</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../about-me.html">About</a>
                </li>
<li>
<a href="../../posts/index.html">Blog</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../notes-and-projects.html">Notes</a>
                </li>
<li>
<a href="../contact.html">Contact</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="windows.org" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Windows notes</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="windows.html#sec-1">1. Notes on Windows</a></li>
<li><a href="windows.html#sec-2">2. Manual deletion of drivers with PnPUtil</a></li>
<li><a href="windows.html#sec-3">3. Disabling CheckDisk (CHKDSK) on startup</a></li>
<li>
<a href="windows.html#sec-4">4. Bash prompt in Windows</a>
<ul>
<li><a href="windows.html#sec-4-1">4.1. Terminal emulators in emacs</a></li>
</ul>
</li>
<li>
<a href="windows.html#sec-5">5. Python in Windows</a>
<ul>
<li><a href="windows.html#sec-5-1">5.1. Python shell and IPython in Emacs + Windows</a></li>
<li><a href="windows.html#sec-5-2">5.2. Installing pymacs in Windows with Emacs 24.3.1</a></li>
<li><a href="windows.html#sec-5-3">5.3. Installing python-mode.el 6.1.3 in Windows with Emacs 24.3.1</a></li>
<li><a href="windows.html#sec-5-4">5.4. Setup pip to use the gcc compiler</a></li>
<li><a href="windows.html#sec-5-5">5.5. Installing numpy, scipy, matplotlib, etc…</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">
<span class="section-number-2">1</span> Notes on Windows</h2>
<div class="outline-text-2" id="text-1">
<p>
This page serves as a collection of notes I've made while using
Windows. It's meant to be a resource to help others and myself when
performing common tasks in Windows.
</p>

<hr>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">
<span class="section-number-2">2</span> Manual deletion of drivers with PnPUtil</h2>
<div class="outline-text-2" id="text-2">
<p>
In the past I have had trouble with FTDI USB chips and needed to
completely wipe the Windows driver store of these drivers. It is not
recommended to manually delete the files from the driver store
(besides, overriding the permissions is a big pain in the
butt). Instead, Microsoft recommends using the tool PnPUtil.
</p>

<p>
To print a list of installed drivers, enter the following command
from a command prompt:
</p>

<div class="highlight"><pre><span></span>pnputil -e &gt; C:\drivers.txt
</pre></div>

<p>
This will print information about all the installed drivers to
C:\drivers.txt.
</p>

<p>
To delete a specific driver, you can look inside the file, find the
associated oemXX.inf (where XX is a specific number for each driver)
and issue the following command:
</p>

<div class="highlight"><pre><span></span>pnputil -d oemXX.inf
</pre></div>

<p>
You may also need to issue a -f flag to force a deletion if the device
is still in use:
</p>

<div class="highlight"><pre><span></span>pnputil -f -d oemXX.inf
</pre></div>

<hr>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">
<span class="section-number-2">3</span> Disabling CheckDisk (CHKDSK) on startup</h2>
<div class="outline-text-2" id="text-3">
<p>
Windows check disk causes me all sorts of pain at work. I can
disable it for certain drives by adding <b>/k:&lt;drive letter&gt;</b> before
the asterisk in the <b>BootExecute</b> Windows registry key at
<b>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session
Manager\</b>. I disabled the F:\ and M:\ drives by adding /k:M and /k:F
before the *.
</p>

<hr>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">
<span class="section-number-2">4</span> Bash prompt in Windows</h2>
<div class="outline-text-2" id="text-4">
<p>
<i>Information sources</i>
</p>
<ol class="org-ol">
<li>
<a href="http://www3.ntu.edu.sg/home/ehchua/programming/howto/cygwin_Howto.html">http://www3.ntu.edu.sg/home/ehchua/programming/howto/cygwin_Howto.html</a>
</li>
</ol>
<hr>
<p>
<b>UPDATE DECEMBER 2016:</b> A reader recently informed me that the
directions below are for MSYS 1.0. There is however a newer (and
independent) version 2.0 available: <a href="https://msys2.github.io/">https://msys2.github.io/</a>. I
cannot at this point verify whether these instructions will
translate for MSYS2.0.
</p>

<hr>
<p>
I really wanted a bash shell in Windows. I knew that Git for
Windows implemented one, and I found that it's part of MSYS, a
collection of packages for MinGw, <a href="http://www.mingw.org/">the Minimalist GNU for Windows
package</a>.
</p>

<p>
I downloaded the MinGW installer from SourceForge, which is linked
to from the MinGw site. This downloads a GUI based system for
installing various packages to <code>C:\MinGw</code>. I installed the
following packages, found under the <code>Basic Setup</code> menu accessed in
the left-most pane of the MinGW Installation Manager:
</p>

<ol class="org-ol">
<li>mingw32-base (includes the gcc compiler)
</li>
<li>mingw32-gcc-g++
</li>
<li>msys-base (includes the bash shell)
</li>
</ol>
<p>
After installing these packages, I added the following directories
to my system PATH environment variable:
</p>

<div class="highlight"><pre><span></span>C:\MinGW\bin;C:\MinGW\msys\1.0\bin
</pre></div>

<p>
If you don't do this, bash can't find the other associated
programs, like <code>ls</code> and <code>date</code>.
</p>

<hr>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">
<span class="section-number-3">4.1</span> Terminal emulators in emacs</h3>
<div class="outline-text-3" id="text-4-1">
<p>
<i>Sources</i>
</p>
<ol class="org-ol">
<li>
<a href="http://stackoverflow.com/questions/20263012/m-x-term-with-emacs-on-ms-windows-error-spawning-child-process-invalid-argum">http://stackoverflow.com/questions/20263012/m-x-term-with-emacs-on-ms-windows-error-spawning-child-process-invalid-argum</a>
</li>
<li>
<a href="http://www.masteringemacs.org/articles/2010/11/01/running-shells-in-emacs-overview/">http://www.masteringemacs.org/articles/2010/11/01/running-shells-in-emacs-overview/</a>
</li>
<li>
<a href="http://ergoemacs.org/emacs/emacs_unix.html">http://ergoemacs.org/emacs/emacs_unix.html</a>
</li>
</ol>
<hr>
<p>
<b>UPDATE DECEMBER 2016:</b> See my note above about using MSYS 2.0. The
directions below might work with MSYS 2.0 by changing the path to
bash.exe to the appropriate one in the MSYS 2.0 directory tree, but
I have not verified this myself.
</p>

<hr>
<p>
Once I had the shell working, I wanted to <i>also</i> use it in Emacs on
Windows through a terminal emulator. Unfortunately, I don't think
that this is possible, based on the StackOverflow discussion linked
to above. However, I can run bash.exe in Emacs' shell mode.
</p>

<p>
To do this, I added the following lines to my <b>init.el</b> file:
</p>

<div class="highlight"><pre><span></span>(setq explicit-shell-file-name "C:/MinGW/msys/1.0/bin/bash.exe")
(setq shell-file-name "bash")
(setenv "SHELL" shell-file-name)
(add-hook 'comint-output-filter-functions 'comint-strip-ctrl-m)
</pre></div>

<p>
This allowed me to use bash as the default shell. 
</p>

<hr>
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">
<span class="section-number-2">5</span> Python in Windows</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">
<span class="section-number-3">5.1</span> Python shell and IPython in Emacs + Windows</h3>
<div class="outline-text-3" id="text-5-1">
<p>
<i>Sources</i>
</p>
<ol class="org-ol">
<li>
<a href="http://stackoverflow.com/questions/8865867/python-shell-in-emacs-24">http://stackoverflow.com/questions/8865867/python-shell-in-emacs-24</a>
</li>
<li>
<a href="http://www.emacswiki.org/emacs/PythonProgrammingInEmacs">http://www.emacswiki.org/emacs/PythonProgrammingInEmacs</a>
</li>
<li>
<a href="http://ipython.org/pyreadline">http://ipython.org/pyreadline</a>
</li>
<li>
<a href="https://bugs.launchpad.net/python-mode/+bug/1103588">https://bugs.launchpad.net/python-mode/+bug/1103588</a>
</li>
</ol>
<p>
I can get a basic Python shell within Emacs on Windows by adding the
following line to my <b>init.el</b> file:
</p>

<div class="highlight"><pre><span></span>(setq python-shell-interpreter "C:/Python34/python.exe")
</pre></div>

<p>
However, I can't print graphs through matplotlib from within this
shell.
</p>

<p>
After installing IPython, I could in fact print graphs using
<b>plt.show()</b> and changing <b>python-shell-interpreter</b> and
<b>python-shell-interpreter-args</b> as follows:
</p>

<div class="highlight"><pre><span></span>(setq
  python-shell-interpreter "C:\\Python34\\python.exe"
  python-shell-interpreter-args
    "-i C:\\Python34\\Scripts\\ipython-script.py console --matplotlib"
  python-shell-prompt-regexp "In \\[[0-9]+\\]: "
  python-shell-prompt-output-regexp "Out\\[[0-9]+\\]: "
  python-shell-completion-setup-code
    "from IPython.core.completerlib import module_completion"
  python-shell-completion-module-string-code
    "';'.join(module_completion('''%s'''))\n"
  python-shell-completion-string-code
    "';'.join(get_ipython().Completer.all_completions('''%s'''))\n")
</pre></div>

<p>
Note that this configuration is specific to Windows and configures
python.el, which is built into Emacs 24.2+. I also made slight
modifications to the variable <b>python-shell-interpreter-args</b> to
include the argument <b>console –matplotlib</b> (see source 4
above). Finally, I installed the package <b>pyzmq</b> using pip. These
steps were crucial to get interactive plotting to work in an emacs
python shell.
</p>

<p>
To get colors working in IPython on Windows, simply use pip to
install PyReadline.
</p>

<hr>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">
<span class="section-number-3">5.2</span> Installing pymacs in Windows with Emacs 24.3.1</h3>
<div class="outline-text-3" id="text-5-2">
<p>
<i>Sources</i>
</p>
<ol class="org-ol">
<li>
<a href="http://pymacs.progiciels-bpi.ca/pymacs.html#installation">http://pymacs.progiciels-bpi.ca/pymacs.html#installation</a>
</li>
<li>
<a href="https://bbs.archlinux.org/viewtopic.php?id=142260">https://bbs.archlinux.org/viewtopic.php?id=142260</a>
</li>
</ol>
<p>
Pymacs is easily installed on Windows. I first cloned the
repository in a GitShell(version 0.25 on May 8, 2014)
</p>

<div class="highlight"><pre><span></span>git clone git://github.com/pinard/Pymacs
</pre></div>

<p>
Following this, I ran the command <b>make check</b> in the folder
containing the cloned repository. I could run <b>make</b> on Windows
because I use MinGW and these binaries were on my system PATH
environment variable. My system passed 166 tests but failed 1. It
didn't seem to matter in the end though; the failure was a Python
assertion error related to the version of Pymacs I downloaded.
</p>

<p>
<b>Note:</b> The directories that contained my emacs and Python binaries
were on my system PATH environment variable. If they are not, the
<b>make check</b> utility may not locate the binaries.
</p>

<p>
I next ran <b>make install</b> and then ran <b>python setup.py
install</b>. Both ran without any problems. However, I could not
import Pymacs into Python. I changed line 299 of Pymacs.py from
<b>except ProtocolError, exception:</b> to <b>except ProtocolError as
exception:</b> and then I could import the file.
</p>

<p>
Finally, I copied pymacs.el into my <b>~/.emacs.d/my-packages/</b>
directory and added the following lines to <b>init.el</b>:
</p>

<div class="highlight"><pre><span></span>;;; Pymacs
(add-to-list 'load-path "~/.emacs.d/my-packages/pymacs-0.25")
(autoload 'pymacs-apply "pymacs")
(autoload 'pymacs-call "pymacs")
(autoload 'pymacs-eval "pymacs" nil t)
(autoload 'pymacs-exec "pymacs" nil t)
(autoload 'pymacs-load "pymacs" nil t)
(autoload 'pymacs-autoload "pymacs")
;;(eval-after-load "pymacs"
;;  '(add-to-list 'pymacs-load-path YOUR-PYMACS-DIRECTORY"))
</pre></div>

<p>
The last two lines are commented out and are only needed if I have
pymacs code in a directory that should be searched first in the
Python import search path.
</p>

<hr>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">
<span class="section-number-3">5.3</span> Installing python-mode.el 6.1.3 in Windows with Emacs 24.3.1</h3>
<div class="outline-text-3" id="text-5-3">
<p>
python-mode.el has a few things that I like over python.el, which
is included in Emacs 24.2+.
</p>

<p>
python-mode.el is very easily installed. I downloaded version 6.1.3
from <a href="https://launchpad.net/python-mode">https://launchpad.net/python-mode</a> and unpackaged the .tar.gz
file into <b>~/.emacs.d/my-packages/python-mode.el-6.1.3</b>.
</p>

<p>
Then, I added the following lines to my <b>init.el</b> file:
</p>

<div class="highlight"><pre><span></span>;;; python-mode.el
(add-to-list 'load-path "~/.emacs.d/my-packages/python-mode.el-6.1.3") 
(setq py-install-directory "~/.emacs.d/my-packages/python-mode.el-6.1.3")
(require 'python-mode)
</pre></div>

<p>
Python-mode does some insane things with Window splitting in emacs
on Windows when executing code. I just stopped window splitting
altogether by adding <b>(setq py-split-windows-on-execute-p nil)</b>
after the <b>(require 'python-mode)</b> line.
</p>

<hr>
</div>
</div>
<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">
<span class="section-number-3">5.4</span> Setup pip to use the gcc compiler</h3>
<div class="outline-text-3" id="text-5-4">
<p>
<i>Information sources</i>
</p>
<ol class="org-ol">
<li>
<a href="http://blog.markstahler.ca/2010/08/python-development-on-windows-setuptools-pip-configuration/">http://blog.markstahler.ca/2010/08/python-development-on-windows-setuptools-pip-configuration/</a>
</li>
</ol>
<p>
The Python package repository, pip, will typically try to use
Visual Studio as its compiler on Windows. I've run into a lot of
errors and tedious customizations to get Visual Studio working with
pip however.
</p>

<p>
Instead, I configured pip to use the gcc compiler in MinGw. After
installing MingGw, I created a text file called <b>pydistutils.cfg</b>
in <b>C:\Users\douglass</b> that contained the following lines:
</p>

<div class="highlight"><pre><span></span>[build]
compiler = mingw32
</pre></div>

<hr>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">
<span class="section-number-3">5.5</span> Installing numpy, scipy, matplotlib, etc…</h3>
<div class="outline-text-3" id="text-5-5">
<p>
<i>Sources</i>
</p>
<ol class="org-ol">
<li>
<a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/">http://www.lfd.uci.edu/~gohlke/pythonlibs/</a>
</li>
</ol>
<p>
I have found that pip is not very good at resolving package
dependencies. For example, I ran into issues installing numpy using
pip because I didn't have BLAS already installed. I've read that
<b>conda</b> is pretty good with resolving dependencies, but I really
didn't want to download/install another package manager.
</p>

<p>
Many 64-bit binaries can be found at the website above. I
downloaded the 64 bit binaries matching my Python version (3.4) for
numpy, scipy, and matplotlib here. Next, I moved the binaries to
<b>C:\Python34\Scripts</b> and installed each with <b>easy_install.exe</b>:
</p>

<div class="highlight"><pre><span></span>easy_install numpy-MKL-1.8.1.win-amd64-py3.4.exe
easy_install scipy-0.14.0.win-amd64-py3.4.exe
easy_install matplotlib-1.3.1.win-amd64-py3.4.exe
</pre></div>

<p>
I had no troubles installing Pillow (for image processing) with
pip3.
</p>

<hr>
</div>
</div>
</div>
    </div>
    

</article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2017         <a href="mailto:kyle.douglass@epfl.ch">Kyle M. Douglass</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
