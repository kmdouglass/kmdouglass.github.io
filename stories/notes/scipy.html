<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="http://kmdouglass.github.io/stories/notes/scipy.html">
<meta name="description" content="Notes on using Python tools for scientific applications.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Scientific Python Notes | Kyle M. Douglass</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="http://kmdouglass.github.io/stories/notes/scipy.html">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><meta name="description" itemprop="description" content="Notes on using Python tools for scientific applications.">
<meta name="author" content="Kyle M. Douglass">
<meta property="og:site_name" content="Kyle M. Douglass">
<meta property="og:title" content="Scientific Python Notes">
<meta property="og:url" content="http://kmdouglass.github.io/stories/notes/scipy.html">
<meta property="og:description" content="Notes on using Python tools for scientific applications.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-01-14T00:00:00+01:00">
<meta property="article:tag" content="python">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://kmdouglass.github.io/">

                <span id="blog-title">Kyle M. Douglass</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../about-me.html">About</a>
                </li>
<li>
<a href="../notes-and-projects.html">Notes</a>
                </li>
<li>
<a href="../../posts/index.html">Blog</a>
                </li>
<li>
<a href="../../categories/index.html">Tags</a>
                </li>
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../contact.html">Contact</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>
    <a href="scipy.org" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Scientific Python Notes</a></h1>

        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li>
<a href="scipy.html#sec-1">1. matplotlib</a>
<ul>
<li><a href="scipy.html#sec-1-1">1.1. Removing parts of the frame</a></li>
<li><a href="scipy.html#sec-1-2">1.2. Changing the frame linewidth</a></li>
<li><a href="scipy.html#sec-1-3">1.3. Remove the legend frame</a></li>
<li><a href="scipy.html#sec-1-4">1.4. Tight layout (fixing clipped axes titles)</a></li>
<li>
<a href="scipy.html#sec-1-5">1.5. Changing matplotlib font families and size</a>
<ul>
<li><a href="scipy.html#sec-1-5-1">1.5.1. Clear the matplotlib font cache</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="scipy.html#sec-2">2. Jupyter at Startup</a></li>
<li>
<a href="scipy.html#sec-3">3. Installing and working with multiple versions of Python</a>
<ul>
<li><a href="scipy.html#sec-3-1">3.1. Building Python and installing binaries to a non-default location</a></li>
<li><a href="scipy.html#sec-3-2">3.2. Setting the interpreter in a virtualenv</a></li>
<li><a href="scipy.html#sec-3-3">3.3. Required system packages for optional Python features</a></li>
</ul>
</li>
<li>
<a href="scipy.html#sec-4">4. Installing Spyder inside a virtuanlenv</a>
<ul>
<li><a href="scipy.html#sec-4-1">4.1. Install SIP and PyQt4 inside the virtualenv</a></li>
<li><a href="scipy.html#sec-4-2">4.2. Install Spyder</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">
<span class="section-number-2">1</span> matplotlib</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">
<span class="section-number-3">1.1</span> Removing parts of the frame</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Some journals disallow having the right and top lines outlining a
plot. For these situations, you can remove them by using methods
associated to the <i>spines</i> field of your axis object.
</p>

<div class="highlight"><pre>ax.spines['top'].set_visible(False)
ax.spines['right'].set_visible(False)
</pre></div>

<p>
Removing the ticks is done like so:
</p>

<div class="highlight"><pre>ax.yaxis.set_ticks_position('left')
ax.xaxis.set_ticks_position('bottom')
</pre></div>

<hr>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">
<span class="section-number-3">1.2</span> Changing the frame linewidth</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Changing the frame linewidth is achieved by the <i>set_linewidth</i>
method of an axes <i>spine</i> field.
</p>

<div class="highlight"><pre>ax.spines['left'].set_linewidth(0.5)
ax.spines['bottom'].set_linewidth(0.5)
</pre></div>

<hr>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">
<span class="section-number-3">1.3</span> Remove the legend frame</h3>
<div class="outline-text-3" id="text-1-3">
<div class="highlight"><pre>import matplotlib.pyplot as plt
leg = plt.legend()
leg.draw_frame(False)
</pre></div>

<hr>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4">
<span class="section-number-3">1.4</span> Tight layout (fixing clipped axes titles)</h3>
<div class="outline-text-3" id="text-1-4">
<p>
For small figures like those which may go in publications, the axes
titles and labels may fall outside of the figure boundary and
therefore appear clipped.
</p>

<p>
To fix this, matplotlib provides a function called <b>tight_layout()</b>
which automatically moves a subplot to fix the plot within the
figure. It also fixes overlapping axis titles in figures with
multiple subplots.
</p>

<p>
<b>tight_layouts()</b> is provided as a method instance of a Figure
object, or through <b>pyplot</b>.
</p>

<div class="highlight"><pre>plt.tight_layout()
</pre></div>

<p>
Sometimes, the default settings of <b>tight_layout</b> still do not fix
the clipping. In this case, I can adjust its pad, w_pad, or h_pad
arguments to adjust the amount of padding introduced by the
method. The numeric amounts are fractions of the font size. <b>pad</b>
adds padding to the subplots and the figure border, whereas <b>w_pad</b>
and <b>h_pad</b> add padding between individual subplots.
</p>

<hr>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5">
<span class="section-number-3">1.5</span> Changing matplotlib font families and size</h3>
<div class="outline-text-3" id="text-1-5">
<p>
The fonts in figures can be changed with a little help with
matplotlib's <b>font_manager</b>.
</p>

<p>
The following snippet changes the font family to Arial and the size
to 12pt using the font_manager to find the proper name of the
font. (Using font_manager isn't necessary if you know the name
already.)
</p>

<div class="highlight"><pre>import matplotlib.font_manager as font_manager
from matplotlib import rcParams

fontpath = '/usr/share/fonts/truetype/msttcorefonts/Arial.ttf'
prop = font_manager.FontProperties(fname = fontpath)
rcParams['font.family'] = prop.get_name()
rcParams.update({'font.size' : 12})
</pre></div>

<hr>
</div>

<div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1">
<span class="section-number-4">1.5.1</span> Clear the matplotlib font cache</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
It is very important to clear the matplotlib font list cache after
adding new fonts to the system. Otherwise, matplotlib will not be
able to find your font.
</p>

<p>
Many forums suggest that this cache is named <b>fontList.cache</b> and
is located at <b>~/.config/matplotlib/</b>. However, this <i>is not</i> the
location where my cache file is stored, nor is it the name of the
file.
</p>

<p>
After adding new fonts, I should run the commands
</p>

<div class="highlight"><pre>rm -i ~/.cache/matplotlib/fontList.py3k.cache
rm -ri ~/.cache/matplotlib/tex.cache
</pre></div>

<hr>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">
<span class="section-number-2">2</span> Jupyter at Startup</h2>
<div class="outline-text-2" id="text-2">
<p>
I can get a Jupyter Notebook server running from startup from a
hidden terminal window in Debian Jessie by adding a desktop file to
<code>~./config/autostart</code> named <b>Jupyter.desktop</b> with the following
information:
</p>

<div class="highlight"><pre>[Desktop Entry]
Encoding=UTF-8
Version=0.9.4
Type=Application
Name=Jupyter
Comment=Starts the Jupyter Notebook Server
Exec=/home/kmdouglass/anaconda3/bin/jupyter-notebook --no-browser
OnlyShowIn=XFCE;
StartupNotify=false
Terminal=true
Hidden=false
</pre></div>

<hr>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">
<span class="section-number-2">3</span> Installing and working with multiple versions of Python</h2>
<div class="outline-text-2" id="text-3">
<p>
I sometimes run into problems if I install multiple versions of Python
on the same system. This is largely because my operating system
depends on a specific version of Python and its libraries, and these
can be corrupted if other versions are installed. In addition, I often
want different packages and versions for different projects.
</p>

<p>
To avoid these issues, I started building Python from source and
installing the binaries in a separate folder. I then use a virtualenv
that points to these binaries. This keeps all my Python packages and
binaries completely separate from the system-level Python install.
</p>

<hr>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">
<span class="section-number-3">3.1</span> Building Python and installing binaries to a non-default location</h3>
<div class="outline-text-3" id="text-3-1">
<p>
It's easy to install the Python binaries to a custom directory by
setting the –prefix and –exec-prefix flags when running the
configure script:
</p>

<div class="highlight"><pre>./configure --prefix<span class="o">=</span>~/src/Python3.4.2 --exec-prefix<span class="o">=</span>~/src/Python3.4.2
</pre></div>

<p>
After running this command, make, and make install, the binaries
and libraries will be placed in these directories instead.
</p>

<hr>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">
<span class="section-number-3">3.2</span> Setting the interpreter in a virtualenv</h3>
<div class="outline-text-3" id="text-3-2">
<p>
After setting up virtualenv and virtualenv wrapper, I can create a
new virtual environment that use these binaries with the <i>-p</i> flag
in the mkvirtualenv command:
</p>

<div class="highlight"><pre>mkvirtualenv -p ~/Python3.4.2/bin/python3.4 MY_VENV_NAME
</pre></div>
<hr>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">
<span class="section-number-3">3.3</span> Required system packages for optional Python features</h3>
<div class="outline-text-3" id="text-3-3">
<p>
The following Debian system packages (I am using Jessie now) are
required to build Python with some of its optional features:
</p>
<dl class="org-dl">
<dt> Tkinter </dt>
<dd>tk-dev and possibly python3-tk
</dd>
<dt> dbm </dt>
<dd>libgdbm-dev
</dd>
</dl>
<hr>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">
<span class="section-number-2">4</span> Installing Spyder inside a virtuanlenv</h2>
<div class="outline-text-2" id="text-4">
<p>
Spyder is a pretty good Python IDE for scientific applications. It
mimics Matlab's IDE functionality, which, to be honest, is really
great even considering the annoying things about the Matlab language.
</p>

<p>
Unfortunately, Spyder takes little bit of effort to work with
virtualenvs.
</p>
<hr>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">
<span class="section-number-3">4.1</span> Install SIP and PyQt4 inside the virtualenv</h3>
<div class="outline-text-3" id="text-4-1">
<p>
The primary difficulty with installing Spyder in a virtualenv is not
Spyder itself, but two of its prerequisites: SIP and PyQt4.
</p>

<p>
<a href="http://amyboyle.ninja/Python-Qt-and-virtualenv-in-linux/">Fortunately, there is a relatively painless way</a> to build SIP and PyQt4
for every virtualenv that you want to use Spyder with.
</p>

<p>
First, make sure you have the required libraries installed:
</p>

<div class="highlight"><pre>sudo apt-get install python2.7-dev libxext-dev qt4-dev-tools build-essential
</pre></div>

<p>
Next, download the SIP and PyQt4 Linux source tarballs and unzip them
into separate directories. <b>Enable your virtualenv using</b> <code>workon
MY_VIRTUALENV</code>, enter the SIP directory, and type <code>python
config.py</code>. When it's done you should see that SIP will be installed
to your virtualenv's directory, not your site directory. Finish the
SIP installation with <code>make</code> and <code>sudo make install</code>.
</p>

<p>
After this, move inside the PyQt4 source directory. Configure the Make
file with
</p>

<div class="highlight"><pre>python configure-ng.py -q /usr/bin/qmake-qt4
</pre></div>

<p>
Follow this with another <code>make</code> and <code>sudo make install</code>.
</p>
<hr>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">
<span class="section-number-3">4.2</span> Install Spyder</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Once SIP and PyQt4 are installed, it's really easy to install Spyder:
</p>

<div class="highlight"><pre>pip install spyder
</pre></div>

<p>
Its executable is stored in
/venv_directories/my_virtualenv/bin/spyder3 (if you're using
Python3). Note that you need to build PyQt4 every time you want to
install Spyder inside a different virtualenv.
</p>
</div>
</div>
</div>
    </div>
    

</article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:kyle.douglass@epfl.ch">Kyle M. Douglass</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
