<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Biophysics, optics, and programming.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kyle M. Douglass (old posts, page 2) | Kyle M. Douglass</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="http://kmdouglass.github.io/posts/index-2.html">
<link rel="prev" href="index.html" type="text/html">
<link rel="next" href="index-1.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://kmdouglass.github.io/">

                <span id="blog-title">Kyle M. Douglass</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../stories/about-me.html">About</a>
                </li>
<li>
<a href="../stories/notes-and-projects.html">Notes</a>
                </li>
<li>
<a href="index.html">Blog</a>
                </li>
<li>
<a href="../categories/index.html">Tags</a>
                </li>
<li>
<a href="../archive.html">Archive</a>
                </li>
<li>
<a href="../stories/contact.html">Contact</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="relearning-paraxial-optics.html" class="u-url">Relearning paraxial optics</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Kyle M. Douglass</span></p>
            <p class="dateline"><a href="relearning-paraxial-optics.html" rel="bookmark"><time class="published dt-published" datetime="2015-04-19T11:05:21+02:00" title="2015-04-19 11:05">2015-04-19 11:05</time></a></p>
                <p class="commentline">
        
    <a href="relearning-paraxial-optics.html#disqus_thread" data-disqus-identifier="cache/posts/relearning-paraxial-optics.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>
As a microscopist who designs and builds custom microscopes, I often
find that first order ray tracing is one of the most useful tools I
have. It is most useful to me when I am starting a design or for
checking that I have not made any serious logical blunders when
working at the bench. I also find it to be a good teaching tool and
excellent for communicating my designs to others.
</p>

<p>
Since I have recently made a lot of back-of-the-envelope ray trace
designs for a microscope I am building at work, I have begun to
critically think about why ray tracing works so well and how it fits
inside the structure of the physical theories of optics.
</p>

<p>
Ray tracing is a technique derived from <b>paraxial geometrical optics</b>
and really is just a consequence of the axioms and assumptions in the
development of the theory. When I think back to when I first learned
about paraxial optics, however, I am reminded of severe assumptions
that place limits on the scope of its validity. So how can a theory
that makes such an enormous simplification by treating the
electromagnetic waves described by Maxwell's equations as lines
obeying the rules of geometry still be so useful?
</p>

<p>
In this next series of blog posts, I want to explore this question and
take the time to relearn paraxial optics with the benefit of
hindsight. Physicists typically learn paraxial optics as their first
theory of optics because it is relatively easy as compared to
electromagnetism and quantum optics. I am curious what aspects of the
theory I can appreciate now that I am familiar with the more advanced
optical theories.
</p>

<p>
The picture below might also provide a bit of motivation for why this
interests me: we physicists learn about optics theories in a direction
of increasing complexity during our education. However, this approach
also means that we learn the most general theories last, so it is not
obvious why assumptions and approximations are made in the theories we
learn first. The result, I think, leads to a bit of logical
discordance in our minds that can prevent a clear understanding of the
subject. With this series of posts I hope to remove this cognitive
dissonance and improve my understanding of the field I work in.
</p>


<div class="figure">
<p><img src="../order_of_optics_theories.png" alt="order_of_optics_theories.png"></p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="reading-select-lines-from-a-text-file.html" class="u-url">Reading select lines from a text file</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Kyle M. Douglass</span></p>
            <p class="dateline"><a href="reading-select-lines-from-a-text-file.html" rel="bookmark"><time class="published dt-published" datetime="2015-03-18T08:27:50+01:00" title="2015-03-18 08:27">2015-03-18 08:27</time></a></p>
                <p class="commentline">
        
    <a href="reading-select-lines-from-a-text-file.html#disqus_thread" data-disqus-identifier="cache/posts/reading-select-lines-from-a-text-file.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>
<a href="https://gist.github.com/kmdouglass/507717d339bc82f850ce">I just created a Python Gist</a> for reading select lines from a text file
into memory. I came up with this Gist when I needed to parse the core
log from our <a href="https://www.micro-manager.org/">microscope control software (Micro-Manager)</a>. One of our
devices was continously sending its statistics to the computer, which
would then be recorded to the log. I wanted to find only lines that
contained the statistics by searching for the <b>STATS</b> identifier,
which was unique to these lines.
</p>

<p>
The problem was a bit more difficult than reading just the lines
containing this string because I wanted the statistics only for times
when the software was acquiring a time series of images. Luckily, the
core log also contains lines with unique strings indicating when a
time series was initiated and stopped. All lines in the log are
time-stamped.
</p>

<p>
Below is the Gist I used to solve this problem. The lines that will be
retained in memory will contain the strings in the list lineFilters. I
then define a function named stringIsIn that will return a list of
bool indicating whether each string is present in the line.
</p>

<p>
At the bottom of the Gist, I use a list comprehension to loop over
each line in the file. The line is appended to a growing list called
outputLines if the line contains <i>any</i> of the strings I defined. Note
that it's not necessary to use a separate definition for stringIsIn;
the list comprehension over lineFilters could have been placed inline
with the primary list comprension over lines in the file. I do think
it is more readable the way it is presented below, however.
</p>

<p>
I welcome any comments or suggestions, especially on the <a href="https://gist.github.com/kmdouglass/507717d339bc82f850ce">Gist website</a>
where others may be more likely to find it.
</p>

<div class="highlight"><pre><span class="n">filename</span>    <span class="o">=</span> <span class="s">'myFile.txt'</span>
<span class="n">outputLines</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c"># Keep all lines containing ANY of the following list of strings.</span>
<span class="n">lineFilters</span> <span class="o">=</span> <span class="p">[</span><span class="s">'line 1'</span><span class="p">,</span>
	       <span class="s">'line 2'</span><span class="p">,</span>
	       <span class="s">'line 3'</span><span class="p">]</span>
<span class="n">stringIsIn</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">line</span><span class="p">:</span> <span class="p">[</span><span class="nb">filter</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="nb">filter</span> <span class="ow">in</span> <span class="n">lineFilters</span><span class="p">]</span>


<span class="c"># Read only lines containing one of the strings into memory.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="p">[</span><span class="n">outputLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">file</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">stringIsIn</span><span class="p">(</span><span class="n">line</span><span class="p">))]</span>
</pre></div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="the-basics-of-virtualenv.html" class="u-url">The basics of virtualenv</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Kyle M. Douglass</span></p>
            <p class="dateline"><a href="the-basics-of-virtualenv.html" rel="bookmark"><time class="published dt-published" datetime="2015-02-10T07:47:50+01:00" title="2015-02-10 07:47">2015-02-10 07:47</time></a></p>
                <p class="commentline">
        
    <a href="the-basics-of-virtualenv.html#disqus_thread" data-disqus-identifier="cache/posts/the-basics-of-virtualenv.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>
I use Python 3.4 in most of my data analyses and in some
simulations. I like a lot of its features, like its implementation of
generators, maps, and filters. However, much of the software on my
Debian Wheezy system depends on Python 2.7 to run, such as
<a href="http://www.mendeley.com/">Mendeley</a>. (It used to run just fine with Python 3.4, until I ran an
automatic update and that was the end of that.)
</p>

<p>
To run some Python 2.7 programs, I used to do the following:
</p>

<div class="highlight"><pre>sudo rm /usr/bin/python 
sudo ln -s /usr/bin/python2.7 /usr/bin/python
</pre></div>

<p>
I know. Ouch. Every single time I needed to run a program that
depended on python2.7, I would delete the symlink in /usr/bin, make a
new link to python2.7, and then run my program. When I needed to give
various programs convenient access to python3.4, I would delete the
symlink and create a new one to the newer version.
</p>

<p>
This was dumb, because there is a convenient Python-based tool that
can fix the problem of needing multiple versions of Python (and
libraries!) on the same system. The solution to this problem is called
<a href="https://virtualenv.pypa.io/en/latest/">virtualenv</a>.
</p>

<p>
There are a lot of descriptions about what virtualenv is on the
internet, so I won't bother going into details here. Instead, I will
focus on just the very basics of its setup and use so that I can have
a handy future reference for when I forget how something works and so
that others can profit from what I have learned. Most everything I've
done came from <a href="http://docs.python-guide.org/en/latest/">python-guide.org</a>, so I'm more-or-less putting <a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/">what they
have already said</a> into my own words.
</p>

<p>
To start, I already have Python 2.7 and 3.4 installed on my system. In
principle, you do not need them installed at the system level, but I
already have done this so I will start from there. I first installed
pip for Python 2.7 since I only had pip3 on my system to start. I did
this because I want to keep Python 2.7 as my system's default Python
environment.
</p>

<div class="highlight"><pre>sudo apt-get update
sudo apt-get install python-pip
</pre></div>

<p>
Once installed, I used it to install virtualenv and
<a href="https://virtualenvwrapper.readthedocs.org/en/latest/">virtualenvwrapper</a>. The latter provides some nice features for working
with virtualenv.
</p>

<div class="highlight"><pre>sudo pip install virtualenv
sudo pip install virtualenvwrapper
</pre></div>

<p>
Now, virtualenvwrapper requires an environment variable to tell it
where to store the folders for each virtual environment. This
environment variable is called WORKON_HOME. First, I created the
folder it will point to:
</p>

<div class="highlight"><pre>mkdir ~/Envs
</pre></div>

<p>
Next, I edited my ~/.bashrc and added the following line:
</p>

<div class="highlight"><pre><span class="nb">export </span><span class="nv">WORKON_HOME</span><span class="o">=</span>~/Envs
</pre></div>

<p>
All of my virtual environment files (except for the Python
intepreters) will be stored in this folder. Finally, I restarted my
terminal window so that the environment variable was assigned. You can
check this by typing <code>echo $WORKON_HOME</code> in your new terminal
window. If it returns the path to your new environments folder, then
you should be fine.
</p>

<p>
Next, I ran the virtualwrapper setup script. Note that I did not need
sudo (in fact, sudo could not find a command called ``source'') and
that no output is returned when the script is run.
</p>

<div class="highlight"><pre><span class="nb">source</span> /usr/local/bin/virtualenvwrapper.sh
</pre></div>

<p>
Now virtualenvwrapper should be installed, so let's make a virtual
environment. We can do this using the <code>mkvirtualenv</code> command, followed
by a name for the environment. I will use the name ``venv'' in this
example, like Kenneth Reitz did in his guide that I linked above.
</p>

<div class="highlight"><pre>mkvirtualenv venv
</pre></div>

<p>
To start the new virtual environment, type <code>workon venv</code> and note that
change in the prompt, indicating which environment you are in. You now
have a fresh Python environment to which you can add any library you
wish. To leave the environment, type <code>deactivate</code> into your terminal.
</p>

<p>
One simple test that you can do to see whether your Python environment
really is clean is to run the Python interpreter from inside your
environment and try importing a module that you know is in your
system-wide site packages but not in your virtual environment. For
example, inside venv I type <code>python</code> at the terminal prompt and tried
importing numpy, which I had not yet installed in venv:
</p>

<div class="highlight"><pre>import numpy
</pre></div>

<p>
This returned an <b>ImportError: No module named numpy</b>. Since I do have
numpy installed on my system but not in this environment, it tells me
that the environment is likely clean.
</p>

<p>
To install new libraries, simply use pip or install them to the folder
that was created for this environment in ~/Env. To delete a virtual
environment entirely, use <code>rmvirtual env</code>.
</p>

<p>
Now, how can I specify that I want the virtual environment to use the
python3.4 interpreter in a virtual environment named
``python3-general''? Doing so would solve my original problem. Simply
make a new virtual environment like so:
</p>

<div class="highlight"><pre>mkvirtualenv -p /usr/bin/python3.4 python3-general
</pre></div>

<p>
Voilà. C'est tout. I hope this helps you get up and running with this
great tool!
</p>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="kmdouglass";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2016         <a href="mailto:kyle.douglass@epfl.ch">Kyle M. Douglass</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>


            <script src="../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
