<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>Kyle M. Douglass (python)</title><link>http://kmdouglass.github.io/</link><description></description><atom:link rel="self" href="http://kmdouglass.github.io/categories/python.xml" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Sun, 21 Feb 2016 18:13:20 GMT</lastBuildDate><generator>https://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Simulating microscope pupil functions</title><link>http://kmdouglass.github.io/posts/simulating-microscope-pupil-functions.html</link><dc:creator>Kyle M. Douglass</dc:creator><description>&lt;div tabindex="-1" id="notebook" class="border-box-sizing"&gt;
    &lt;div class="container" id="notebook-container"&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Simple-simulations-of-microscope-pupil-functions"&gt;Simple simulations of microscope pupil functions&lt;a class="anchor-link" href="http://kmdouglass.github.io/posts/simulating-microscope-pupil-functions.html#Simple-simulations-of-microscope-pupil-functions"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0142949"&gt;In one of my recent publications&lt;/a&gt;, my co-authors and I investigated an aberration that is especially pernicious for 3D localization microscopies such as &lt;a href="https://en.wikipedia.org/wiki/Super-resolution_microscopy#STORM.2C_PALM_and_FPALM"&gt;STORM and PALM&lt;/a&gt;. This aberration results in a dependence of the perceived position of a single, fluorescent molecule on its axial position within the focal plane of a microscope. To identify a possible source for this aberration, I employed a phase retrieval algorithm to obtain the pupil function of the microscope. I then decomposed the pupil function into a number of orthogonal polynomial terms and identified the specific terms that led to the aberration that we observed. In this case, terms associated with &lt;a href="https://en.wikipedia.org/wiki/Coma_%28optics%29"&gt;coma&lt;/a&gt; were the culprits.&lt;/p&gt;
&lt;p&gt;So why exactly is coma bad for 3D localization microscopy? Unfortunately, we did not have time to go into the subtleties question in the publication due deadlines on the revisions. Luckily, the internet is a wonderful tool for explaining some of these ideas outside of the formal structure of an academic paper, which is what I will do here.&lt;/p&gt;
&lt;p&gt;To answer the question, we first require a bit of knowledge about Fourier optics. The purpose of this post is to describe what a pupil function is and how it can be easily simulated on a computer with Python. We'll then see how we can use it to model a simple aberration: defocus. A future post will explain why coma is bad for 3D localization microscopy using the foundations built upon here.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Pupil-Function-Basics"&gt;Pupil Function Basics&lt;a class="anchor-link" href="http://kmdouglass.github.io/posts/simulating-microscope-pupil-functions.html#Pupil-Function-Basics"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The pupil function of a microscope (and really, of any optical system) is an important tool for analyzing the aberrations present in the system. The pupil function is defined as the two dimensional Fourier transform of the image of an isotropic point source. &lt;a href="http://mathworld.wolfram.com/FourierTransform.html"&gt;The two dimensional Fourier transform&lt;/a&gt; of a function of two variables x and y is expressed as&lt;/p&gt;
$$F \left( k_x, k_y \right) = \iint f \left( x, y \right) \exp \left[ -j \left( k_{x}x + k_{y}y \right) \right] dx dy$$&lt;p&gt;(I was originally trained as an engineer, so I tend to use 'j' for the imaginary number more than 'i'.) The inverse Fourier transform converts \(F \left( k_x, k_y \right)\) back into \(f \left( x, y \right)\) and is given by&lt;/p&gt;
$$f \left( x, y \right) = \iint F \left( k_x, k_y \right) \exp \left[ j \left( k_{x}x + k_{y}y \right) \right] dk_x dk_y$$&lt;p&gt;In this case, \(x\) and \(y\) are variables representing 2D coordinates in the image plane and \(k_x\) and \(k_y\) are the spatial frequencies. \(f \left( x, y \right)\) and \(F \left( k_x, k_y \right)\) are known as Fourier transform pairs.&lt;/p&gt;
&lt;p&gt;An isotropic point source is an idealized source of electromagnetic radiation that emits an equal intensity in all directions. Strictly speaking, real sources such as atoms and molecules are dipoles and not isotropic emitters. This assumption is however a good model for collections of many fluorescent molecules possessing dipole moments that are all pointing in different directions and that are smaller than the wavelength of light because the molecules' individual emission patterns average out. It is also a good approximation for a dipole whose moment is randomly reorienting in many directions during an image acquisition due to thermally-induced rotational diffusion.&lt;/p&gt;
&lt;p&gt;The image of a point source is known as the &lt;a href="https://en.wikipedia.org/wiki/Point_spread_function"&gt;point spread function (PSF)&lt;/a&gt; of the microscope. In signal processing, it's known as a two dimensional impulse response.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.msg.ucsf.edu/agard/Publications/148-Agard-JMicrosc-2004.pdf"&gt;The equation&lt;/a&gt; that relates the image of the isotropic point source to the pupil function \(P \left( k_x, k_y \right)\) is&lt;/p&gt;
$$\text{PSF}_{\text{A}} \left( x, y \right) = \iint P \left( k_x, k_y \right) \exp \left[ -j \left( k_{x}x + k_{y}y \right) \right] dx dy$$&lt;p&gt;The subscript &lt;code&gt;A&lt;/code&gt; on the PSF stands for &lt;em&gt;amplitude&lt;/em&gt; and means that we are working with the electric field, not the &lt;a href="https://en.wikipedia.org/wiki/Irradiance"&gt;irradiance&lt;/a&gt;. The irradiance, which is what a camera or your eye measures, is proportional to the absolute square of \(\text{PSF}_{\text{A}}\). In words, the above equation restates the definition above: the pupil function and the amplitude PSF are Fourier transform pairs.&lt;/p&gt;
&lt;h3 id="Simulating-Diffraction-Limited-Pupil-Functions-and-PSF's"&gt;Simulating Diffraction Limited Pupil Functions and PSF's&lt;a class="anchor-link" href="http://kmdouglass.github.io/posts/simulating-microscope-pupil-functions.html#Simulating-Diffraction-Limited-Pupil-Functions-and-PSF's"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We can simulate how an aberration affects the image of a point source by simulating an aberrated pupil function and computing the Fourier transform above to get the amplitude PSF. The easiest model to simulate is based on scalar diffraction theory, which means that we ignore the fact that the electromagnetic radiation is polarized (i.e. a vector) and treat it as a scalar quantity instead. Even though this is an approximation, it still can give us a good idea about the fundamental physics involved.&lt;/p&gt;
&lt;p&gt;To perform the simulation, we must first discretize the continuous quantities in the Fourier transform. We'll model \(\text{PSF}_{\text{A}}\) and \(P \left( k_x, k_y \right)\) as discrete scalar quantities on 2D grids and perform a &lt;a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform"&gt;fast Fourier transform&lt;/a&gt; to turn the pupil function into the PSF.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="c"&gt;# Load scientific Python libraries&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;pylab&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.fftpack&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;fft2&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.fftpack&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;fftshift&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Using matplotlib backend: TkAgg
Populating the interactive namespace from numpy and matplotlib
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'dark_background'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'image.cmap'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'plasma'&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's start by setting up the image plane and spatial frequency grids. If we work with square images, then the primary quantity we have to set a value for is the number of pixels. The number of pixels that we choose to simulate is a bit arbitrary, though as we'll see later, it determines the spacing of the discretized pupil function coordinates.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;513&lt;/span&gt; &lt;span class="c"&gt;# Choose an odd number to ensure rotational symmetry about the center&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The rest of the important parameters for setting up the grids are determined by your microscope.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;wavelength&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.68&lt;/span&gt; &lt;span class="c"&gt;# microns&lt;/span&gt;
&lt;span class="n"&gt;NA&lt;/span&gt;         &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.4&lt;/span&gt;  &lt;span class="c"&gt;# Numerical aperture of the objective&lt;/span&gt;
&lt;span class="n"&gt;nImmersion&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.51&lt;/span&gt; &lt;span class="c"&gt;# Refractive index of the immersion oil&lt;/span&gt;
&lt;span class="n"&gt;pixelSize&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;  &lt;span class="c"&gt;# microns, typical for microscopes with 60X--100X magnifications&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now we have enough information to define the grid on which the pupil function lies.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;kMax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;pixelSize&lt;/span&gt; &lt;span class="c"&gt;# Value of k at the maximum extent of the pupil function&lt;/span&gt;
&lt;span class="n"&gt;kNA&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;NA&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;wavelength&lt;/span&gt;
&lt;span class="n"&gt;dk&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;pixelSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;When working with discrete Fourier transforms, a common question that arises is "What are the units of the Fourier transform variable?" We can answer this question by easily remembering these rules:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;\(k_{Max} \propto \frac{1}{dx}\)&lt;/p&gt;
&lt;p&gt;\(x_{Max} \propto \frac{1}{dk}\)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;These two rules are just a manifestation of the &lt;a href="https://en.wikipedia.org/wiki/Nyquist%E2%80%93Shannon_sampling_theorem"&gt;Nyquist-Shannon sampling criterion&lt;/a&gt;: the maximum spatial frequency \( k_{Max} \) is determined by the inverse of the sampling period in space \(dx\), while the maximum size \(x_{Max}\) of the signal is proportional to the inverse of the period of spatial frequency samples \(dk\). This is why the maximum spatial frequency above is \(2 \pi / \text{pixelSize}\).&lt;/p&gt;
&lt;p&gt;The pupil function of a microscope is non-zero for values of \(\left( k_x, k_y \right)\) such that \(k_x^2 + k_y^2 \leq \frac{2 \pi NA}{\lambda}\). The quantity \(\frac{2 \pi NA}{\lambda}\) is represented by &lt;code&gt;kNA&lt;/code&gt; above. The size of a pixel &lt;code&gt;dk&lt;/code&gt; in spatial frequency units (radians per distance) is inversely proportional to the maximum size of the image in pixels, or &lt;code&gt;imgSize * pixelSize&lt;/code&gt;. Likewise, the size of a pixel in microns is proportional to the inverse of the maximum size of the pupil function in spatial frequencies. This is just a manifestation of the properties of Fourier transform pairs.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;kx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;kMax&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kMax&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ky&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;kMax&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kMax&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;dk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dk&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;KX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;KY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;meshgrid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ky&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# The coordinate system for the pupil function&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'kmin : {0}'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'kmax : {0}'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Size of kx : {0}'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;kmin : -31.354686913020938
kmax : 31.354686913020036
Size of kx : 513
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now that the coordinate system for the pupil function is setup, we can go ahead and define the pupil function for an &lt;em&gt;aberration free&lt;/em&gt; microscope. First, we need to create a mask whose value is one inside a circle whose extent is set by the microscope's NA and zero outside it. This mask is used to create a circular pupil.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [32]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;maskRadius&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;kNA&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;dk&lt;/span&gt; &lt;span class="c"&gt;# Radius of amplitude mask for defining the pupil&lt;/span&gt;
&lt;span class="n"&gt;maskCenter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;W&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;H&lt;/span&gt;       &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;meshgrid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;mask&lt;/span&gt;       &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;W&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;maskCenter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;maskCenter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;maskRadius&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mask&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;ky&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;ky&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'kx, rad / micron'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'ky, rad / micron'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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%0ARM3/Azyy/NhZQ9SpAAAAAElFTkSuQmCC"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The pupil function is a complex quantity, which means it has both real and imaginary components. The unaberrated pupil function for an on-axis point source simply has a uniform phase and amplitude equal to one inside the mask.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;amp&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;mask&lt;/span&gt;
&lt;span class="n"&gt;phase&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;pupil&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;amp&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phase&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [39]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nrows&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sharey&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;figsize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;img0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;amp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;ky&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;ky&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;())))&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Pupil function amplitude'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'kx, rad / micron'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'ky, rad / micron'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;img1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;phase&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;kx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;ky&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;ky&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;())))&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Pupil function phase'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'kx, rad / micron'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmQAAAGJCAYAAAAkIy99AAAABHNCSVQICAgIfAhkiAAAAAlwSFlz%0AAAALEgAACxIB0t1+/AAAIABJREFUeJzt3Xd0VHXi/vFn6BYSmrQ06cUCRAWlROnNJYjI4q6iWL6K%0AqFiWEpRFz6pEdhXQBXHBhcjCgqBSpIRAgNBZUwgQSgRMQoCwJJCwQSCE+/vDH6MRkiGQmc+U9+uc%0Ae05m7syd5zPAhyf33plrk2QJAAAAxpQzHQAAAMDXUcgAAAAMo5ABAAAYRiEDAAAwjEIGAABgGIUM%0AAADAMAqZjxkzZow+//xzSVJwcLAKCwtls9mu+tgmTZooISFBp0+f1vDhw12WMTAwULm5uS57PWf4%0A7Xu7fPlyPfHEE2W2/djYWA0dOrTMtgd4I+a74g0ZMkRxcXEuf12UzGJxv+Xw4cNWfn6+lZubax09%0AetT65z//ad10001l+hrBwcHWxYsXLZvNdtX1M2bMsP72t785fayHDh2yOnfubPw9d9V7O2TIECsu%0ALu6Gth8bG2sNHTrU+DhZWMpiYb5z/TJkyBBrw4YNxnOw/LKwh8xNWZalvn37yt/fX6Ghobr33nv1%0A9ttvuzRDSEiI9uzZ49LX9AU2m02WZZmOAbgN5juAQ5Zu7fKu9ePHj2vlypW68847JUmHDh1S586d%0A7Y/785//rC+//FLSL7vln3vuOR05ckRHjhzRG2+8cdXHlmTNmjXq3Lmzpk6dqtzcXDVq1OiKw2S/%0A3eVdWFio//u//9P+/fuVnZ2tTz/9tMg2n3vuOe3Zs0e5ubnatWuXWrVqpaioKAUHB2vZsmXKzc3V%0Am2++ecWhhbp162rx4sU6efKk9u/fr2effbbIeObPn6/Zs2crNzdXycnJatOmTbHjmjRpktLS0nT6%0A9Gnt2LFDHTp0KLKtBQsW6Msvv1Rubq6SkpLUuHFjjR49WsePH9fhw4fVrVs3++NjY2P1/vvva9u2%0AbTp9+rS++eYb+fv7X/V1L793zZo102effaYHHnhAeXl5ys7OLrK+uPe2W7duSklJUU5Ojj755JMr%0ADrsMHTpUe/bs0cmTJ7VixQoFBQUV+x4A7oj5ruznu8LCQr388sv64YcflJWVpQ8//PCK93zixInK%0Azs7WDz/8oJ49e9rXPfXUU/b8qampev755+3ratSooaVLlyonJ0cnT57U+vXr7evq1q2rhQsXKisr%0ASz/88INefvllh+8/fkYh8wCBgYHq06ePEhISin3Mb/e4PPTQQ2rUqJF69uyp0aNHF5nQrmXvTLdu%0A3bRx40YNHz5c/v7+Onjw4DW9bt++fXXPPfeoVatWGjRokLp37y5JGjhwoP785z/riSeekL+/v/r1%0A66fs7Gw99dRTSk9P18MPPyx/f3999NFHV2x3wYIFSk9PV926dfXYY4/pgw8+0IMPPmhf/7vf/U7z%0A5s2Tv7+/li1bpqlTpxY7rh07dujuu+9W9erVNW/ePC1cuFAVK1a0r3/44YcVFRWlatWqKSkpSTEx%0AMbLZbKpfv77ee+89+/kolz355JN6+umnVbduXRUWFl4xKf/W/v379eKLL2rr1q3y8/NTzZo1i33s%0A5fegZs2a+vrrrzV27FjVqlVLBw8eLFIk+/XrpzFjxqh///667bbbtHHjRv373/8uMQfgrpjvym6+%0Ak6T+/fsrNDRUoaGhCg8PL1Iy27Vrp71796pmzZr661//qi+++MK+LisrS3369JG/v7+GDh2qSZMm%0AqVWrVpKkN998UxkZGapZs6Zq166tsWPH2p+3bNkyJSYmql69euratatGjBhR5BdZFI9C5sYWL16s%0A7OxsxcXFad26dZowYcI1P/edd97R+fPntWfPHs2aNUuPP/64E5P+YsKECfrf//6nI0eOaN26dWrd%0AurUk6dlnn9XEiROVmJgoSTp8+LCOHDlif15xJ9oGBgbqgQce0OjRo3Xx4kUlJydr5syZGjJkiP0x%0AmzZt0urVqyVJc+bM0d13311svn//+9/Kzc2VZVmaPHmyKleurGbNmtnXb9y4UWvXrpVlWVq4cKFq%0A1KihyMhIXbp0SfPnz9ftt9+uqlWr2h8/Z84c7du3T+fOndO4ceM0aNCg63jXSta7d2/t3r1bixcv%0A1qVLlzRlyhQdP37cvv6FF17QhAkTlJqaKsuyFBkZqdatWyswMLDMswDOwnxX9vOdJEVGRiovL0+Z%0AmZmaPHlykffmxx9/1KxZsyRJUVFRqlu3rm677TZJ0qpVq5SWllbkNTt16iRJKigoUL169dSgQQNd%0AunRJW7ZskSTdd999qlWrlj744ANdunRJaWlpmjlzpgYPHnyN76hvo5C5sfDwcNWsWVMNGzbUq6++%0AqgsXLlzT8yzLKvKPPy0tTfXr13dWzCKysrLsP589e1a33nqrJCkoKKjY3zpLUq9ePeXk5Oinn36y%0A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%0A1crauXOn/b7IyEhr5MiRliRr1KhR1oQJE4znLM1Sp04dq1WrVpYk65ZbbrH27dtnNWvWzOPH5e6L%0AN85fknfOYd4yf0nMYU7KYP5NcKclPDzc+vLLLy1J1ujRo61Ro0bZ161YscJq27at8YylWWJjY4tM%0AZp4+pnbt2lkrVqwodjyetAQHBxeZzPbu3WvVrl3bkn6eGPbu3Ws8440s3377rdW1a1evG5c7L942%0Af0neNYd50/wlMYeV9cIhy9945plntGLFCkk/777MyMiwr8vMzFRAQICpaGXC08f02/xHjhzxqPwl%0AqV27tk6cOCFJysrKUu3atQ0nun4hISFq3bq1tm3bpjp16njNuNydt89fkmePy5vnL4k57EYZu7i4%0Aq61evVp16tSx37bZbLIsS2+99Za+++47SdLYsWNVUFCg+fPnm4pZKtcyJnguT/2OqltuuUWLFi3S%0AiBEjlJ+ff8U4PHVcJnnj/CUxh3k7T/23bmoO85lC1qNHjxLXP/XUU+rTp4+6dOlivy8zM1NBQUH2%0A24GBgcrMzHRaxtJyNKarcfcxOZKZmang4F+uLeZp+Uty+TevEydOFPmNzJOUL19eixYt0pw5c7R0%0A6VJJ3jEu07xx/pJ8bw7z5vlL8o5/66bnMOPHaU0vPXv2tHbv3m3VqFGjyP2XT4qtWLGidfvtt3vU%0AyaOXl9jYWCs0NNRrxlSuXDn7SbEVK1a0EhMTrebNmxvPdT1LSEiIlZycbL8dGRlpP5/EE0+IlWRF%0ARUVZH330UZH7vGFc7rx48/wledcc5k3zl8Qc5oTF/Btgejlw4ID1448/WvHx8VZ8fLw1depU+7ox%0AY8ZYqampVkpKitW9e3fjWa91CQ8Pt9LT062zZ89aR48eLXIiqaeO6fLSs2dPa9++fdaBAwes0aNH%0AG89zPcvcuXOtzMxM69y5c1ZaWpr19NNPW9WqVbNiYmKsffv2WdHR0Za/v7/xnKVZ2rdvb128eNFK%0ATEy0EhISrPj4eKtnz55W9erVPXpc7r544/wlee8c5g3zl8Qc5ozX59JJAAAAhvEpSwAAAMMoZAAA%0AAIZRyAAAAAyjkAEAABhGIQMAADCMQgYAAGAYhQzFCg4OVnJysrHXHzJkiD755JOrritfvry+//77%0A69puaGioJk2adCPRALg55i94Gp+5dBKuT1lfs6tcuXK6dOnSDb9+x44dtWnTpuvKkJCQoISEhGt+%0A/OXr6wHwLMxfzF+ehD1kuCYNGjRQfHy8QkNDNWLECM2cOVOSdOeddyo5OVmVK1cu9rlhYWHasGGD%0AFi9erD179kiSvvnmG+3YsUPJycl69tln7Y99+umntW/fPm3dulUdOnQodpu9evXSypUrr7g/Ly9P%0AH374oXbt2qXo6Gi1bdtW69atU2pqqvr27WvPc/kaZTfffLO++OIL7dy5U4mJierfv799O3/961+V%0AkJCg+++/X126dFF8fLySkpI0Y8YMVajw8+8yhw4d0vjx4/X9998rKSlJTZo0Kc3bCsAFmL+YvzyF%0A8csVsLjnEhwcbO3cudNq0qSJFR8fb91xxx32devWrbPCw8OtHTt2WO3atStxO2FhYVZeXp4VFBRk%0Av+/ypScqV65sJScnW9WqVbPq1Klj/fjjj1b16tWt8uXLWxs3brSmTJly1W1u27bNqly58hX3FxYW%0A2i+l8vXXX1urVq2ybDabddddd1kJCQn2PEuWLLEkWRMmTChy3TI/Pz/7dgYMGGBJsipVqmSlpaVZ%0ADRs2tCRZs2fPtl555RVLknXo0CFr2LBhliTrxRdftP7xj38Y/3NjYWFh/mL+8ryFPWQoUe3atbV4%0A8WL94Q9/sP92KElDhw7VnDlztH79em3fvt3hdnbs2KGMjAz77ddee02JiYnatm2bAgMD1aRJE7Vr%0A107r1q3TqVOnVFhYqAULFlx1W/Xq1VN2drbOnz9/xbrz588rJiZGkrRr1y6tX79elmVp165dCgkJ%0AueLx3bp109SpU+238/LyJEkXL17UN998I0lq1qyZDh06pEOHDkmSoqKiFBYWZn/Ot99+K0mKj4+/%0A6msAMIP5i/nLk1DIUKLc3Fylp6erU6dORe5v2rSpzpw5o/r161/TdvLz8+0/h4WFqUuXLmrXrp3a%0AtGmjpKQkValSRdLP5zs40qtXL0VHR191XUFBgf3nS5cuFZn0Lu+mvxbnzp0rcrukXJdfo7CwsFSv%0AAcC5mL/kMBfzl/ugkKFE58+f1yOPPKIhQ4Zo8ODBkiQ/Pz9NmTJFYWFhqlmzpgYMGCBJuvfeezV7%0A9myH2/T399epU6d04cIFNWvWTPfff78kafv27QoLC1O1atVUoUIFPfbYY1d9fnHnX0glTzxXWxcT%0AE6Phw4cXyfbbx+7fv18hISFq0KCBJOnJJ5/U+vXrSx4kAOOYv5i/PAmFDA6dO3dODz/8sF577TX1%0A7dtXH3/8sT799FMdPHhQzz33nCZMmKCaNWsqODhYZ8+edbi9VatWqWLFitq9e7c++OADbd26VZKU%0AlZWld955R9u2bdPGjRuVkpJyxXNtNpsaNWqk1NTUq267pE8TXW3de++9pxo1aig5OVkJCQl66KGH%0ArnjshQsXNHToUC1atEhJSUkqLCzU559/7vD1AJjH/MX85UmMn8jG4h1LZGRkkRNnnbG0b9/emjp1%0AqvGxsrCweNfC/MVierH9/x8AAABgCIcsAQAADKOQAQAAGEYhAwAAMIxCBgAAYBiFDAAAwDAKGQAA%0AgGEUMgAAAMP+H8BFg/RXIK8bAAAAAElFTkSuQmCC"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The amplitude PSF for the isotropic point source is simply the Fourier transform of this pupil function. The camera, which measures irradiance and not electric field, sees the absolute square of the amplitude PSF.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;psfA_Unaberrated&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fftshift&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fft2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pupil&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;psf&lt;/span&gt;              &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psfA_Unaberrated&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conj&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psfA_Unaberrated&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# PSFA times its complex conjugate&lt;/span&gt;

&lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="c"&gt;# pixels&lt;/span&gt;

&lt;span class="c"&gt;# It is important to set interpolation to 'nearest' to prevent smoothing&lt;/span&gt;
&lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psf&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'nearest'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Position, pixels'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Position, pixels'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;colorbar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This is a simulated image of an on-axis, in-focus, isotropic point source from an unaberrated pupil with an object-space pixel size of 100 nm.&lt;/p&gt;
&lt;p&gt;The image is also a decent approximation of what a real single molecule image looks like in localization microscopies. I say &lt;em&gt;decent&lt;/em&gt; because a single molecule will have a dipolar emission profile, not isotropic. Additionally, the scalar-diffraction model used here ignores polarization effects. Finally, a real image will have noise, which would be reflected as a random variation in the signal of each pixel.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's see how a line profile through the center of the image looks relative to the profile of the &lt;a href="https://en.wikipedia.org/wiki/Airy_disk"&gt;Airy disk&lt;/a&gt;, which is the mathematical solution to the diffraction pattern from a circular aperture in scalar diffraction theory. The Airy disk is given by&lt;/p&gt;
$$I \left( X \right) = I_{0} \left[ \frac{2J_{1} \left( X \right)}{X} \right]^2$$&lt;p&gt;where \(J_{1} \left( X \right) \) is the Bessel function of the first kind and order 1 and \( X = \frac{2 \pi r  (\text{NA})}{\lambda} \). Here, \(r\) is the distance from the center of the image plane, so we can easily convert it to pixels.&lt;/p&gt;
&lt;p&gt;Because the pupil of the microscope is circular and unaberrated, it is also the solution for PSF of the microscope.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.special&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;j1&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;bessel1&lt;/span&gt;
&lt;span class="n"&gt;px&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# pixels&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt;    &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;px&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;NA&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;pixelSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;wavelength&lt;/span&gt; 
&lt;span class="n"&gt;airy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psf&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;bessel1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;

&lt;span class="c"&gt;# Fix point at x = 0 where divide-by-zero occurred&lt;/span&gt;
&lt;span class="n"&gt;airy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psf&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c"&gt;# Take a line profile through the center of the simulated PSF&lt;/span&gt;
&lt;span class="n"&gt;lineProfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;psf&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;px&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;airy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;             &lt;span class="n"&gt;linewidth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'Airy disk'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;px&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lineProfile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;'o'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;markersize&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'Simulated PSF'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Pixels'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Irradiance, a.u.'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;
&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;/home/kmdouglass/.venvs/Nikola/lib/python3.5/site-packages/ipykernel/__main__.py:4: RuntimeWarning: invalid value encountered in true_divide
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The simulated PSF agrees well with the scalar diffraction theory, demonstrating that we have correctly simulated the microscope's PSF from an unaberrated pupil function.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Defocus"&gt;Defocus&lt;a class="anchor-link" href="http://kmdouglass.github.io/posts/simulating-microscope-pupil-functions.html#Defocus"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now that we can simulate the diffraction-limited image of an &lt;em&gt;in-focus&lt;/em&gt; isotropic point source, let's add some defocus to demonstrate what the PSF would look like as the camera or sample is scanned along the axial direction.&lt;/p&gt;
&lt;p&gt;Defocus can be added in numerous ways. One is to multiply our pupil function by the phase aberration for defocus, which is usually modeled as a parabolic phase aberration in the pupil coordinates. However, &lt;a href="http://kmdouglass.github.io/posts/beware-the-paraxial-approximation-in-microscopy.html"&gt;as I explained in a previous post&lt;/a&gt;, this is an approximate model for defocus and fails for large numerical apertures.&lt;/p&gt;
&lt;p&gt;Another simple way is to propagate the plane wave angular spectrum in the image plane to nearby planes. This relatively easy method is used in a well-known microscopy paper (&lt;a href="http://onlinelibrary.wiley.com/doi/10.1111/j.0022-2720.2004.01393.x/abstract"&gt;Hanser, 2004&lt;/a&gt;) and involves multiplying the pupil function by a defocus kernel before performing the Fourier transform.&lt;/p&gt;
$$\text{PSF}_{\text{A}} \left( x, y, z \right) = \iint P \left( k_x, k_y \right) \exp \left( j k_{z} z \right) \exp \left[ -j \left( k_{x}x + k_{y}y \right) \right] dx dy$$&lt;p&gt;Here, \(k_z = \sqrt{\left( 2 \pi n / \lambda \right)^2 - k_x^2 - k_y^2}\). The defocus kernel essentially shifts the phase of each plane wave with pupil coordinates \(\left( k_x, k_y \right)\) by an amount that depends on its coordinates and the distance from the image plane \(z\).&lt;/p&gt;
&lt;p&gt;The above equation means that we can model the PSF behavior as we scan through the focal plane by computing the defocus kernel for different distances from focus. Then, we multiply our perfect pupil by this defocus kernel and compute its Fourier transform to get the amplitude and irradiance PSF's.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="c"&gt;# Defocus from -1 micron to + 1 micron&lt;/span&gt;
&lt;span class="n"&gt;defocusDistance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;arange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;defocusPSF&lt;/span&gt;      &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;imgSize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;defocusDistance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;ctr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusDistance&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c"&gt;# Add 0j to ensure that np.sqrt knows that its argument is complex&lt;/span&gt;
    &lt;span class="n"&gt;defocusPhaseAngle&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pi&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;nImmersion&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;wavelength&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;KX&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;KY&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;defocusKernel&lt;/span&gt;       &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusPhaseAngle&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;defocusPupil&lt;/span&gt;        &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pupil&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;defocusKernel&lt;/span&gt;
    &lt;span class="n"&gt;defocusPSFA&lt;/span&gt;         &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fftshift&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fft2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusPupil&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;defocusPSF&lt;/span&gt;&lt;span class="p"&gt;[:,:,&lt;/span&gt;&lt;span class="n"&gt;ctr&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusPSFA&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conj&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusPSFA&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;And that's it. All we needed to do was multiply pupil by the defocus kernel and compute the FFT like before. Now let's look at a couple of defocused PSF's at different distances from the focal plane.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nrows&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ncols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="c"&gt;# pixels&lt;/span&gt;
&lt;span class="n"&gt;indx&lt;/span&gt;      &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c"&gt;# indexes to defocus distances to plot&lt;/span&gt;

&lt;span class="c"&gt;# Find the maximum in the in-focus image for displaying PSF's on the correct intensity scale&lt;/span&gt;
&lt;span class="n"&gt;maxIrradiance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusPSF&lt;/span&gt;&lt;span class="p"&gt;[:,:,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusPSF&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="n"&gt;indx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;vmin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vmax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;maxIrradiance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'nearest'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'x-position, pixels'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'y-position, pixels'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Defocus: {0:.2f} microns'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusDistance&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;indx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]))&lt;/span&gt;

&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusPSF&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;:,&lt;/span&gt; &lt;span class="n"&gt;indx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="n"&gt;vmin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vmax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;maxIrradiance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interpolation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'nearest'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylim&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;imgSize&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;zoomWidth&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_xlabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'x-position, pixels'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_ylabel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'y-osition, pixels'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_title&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Defocus: {0:.2f} microns'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;defocusDistance&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;indx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]))&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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%0AYII="&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;
&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As more and more defocus is added to the pupil, the PSF gets dimmer because the same number of photons are spread out across a larger area of the detector.&lt;/p&gt;
&lt;p&gt;In a future post I'll discuss how we can model arbitrary aberrations within this framework. The idea is similar to how defocus is implemented here: you find the phase profile for the aberration, multiply it by the unaberrated pupil, and finally compute the 2D Fourier transform.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</description><category>microscopy</category><category>optics</category><category>python</category><guid>http://kmdouglass.github.io/posts/simulating-microscope-pupil-functions.html</guid><pubDate>Sun, 24 Jan 2016 14:13:40 GMT</pubDate></item><item><title>Reading select lines from a text file</title><link>http://kmdouglass.github.io/posts/reading-select-lines-from-a-text-file.html</link><dc:creator>Kyle M. Douglass</dc:creator><description>&lt;p&gt;
&lt;a href="https://gist.github.com/kmdouglass/507717d339bc82f850ce"&gt;I just created a Python Gist&lt;/a&gt; for reading select lines from a text file
into memory. I came up with this Gist when I needed to parse the core
log from our &lt;a href="https://www.micro-manager.org/"&gt;microscope control software (Micro-Manager)&lt;/a&gt;. One of our
devices was continously sending its statistics to the computer, which
would then be recorded to the log. I wanted to find only lines that
contained the statistics by searching for the &lt;b&gt;STATS&lt;/b&gt; identifier,
which was unique to these lines.
&lt;/p&gt;

&lt;p&gt;
The problem was a bit more difficult than reading just the lines
containing this string because I wanted the statistics only for times
when the software was acquiring a time series of images. Luckily, the
core log also contains lines with unique strings indicating when a
time series was initiated and stopped. All lines in the log are
time-stamped.
&lt;/p&gt;

&lt;p&gt;
Below is the Gist I used to solve this problem. The lines that will be
retained in memory will contain the strings in the list lineFilters. I
then define a function named stringIsIn that will return a list of
bool indicating whether each string is present in the line.
&lt;/p&gt;

&lt;p&gt;
At the bottom of the Gist, I use a list comprehension to loop over
each line in the file. The line is appended to a growing list called
outputLines if the line contains &lt;i&gt;any&lt;/i&gt; of the strings I defined. Note
that it's not necessary to use a separate definition for stringIsIn;
the list comprehension over lineFilters could have been placed inline
with the primary list comprension over lines in the file. I do think
it is more readable the way it is presented below, however.
&lt;/p&gt;

&lt;p&gt;
I welcome any comments or suggestions, especially on the &lt;a href="https://gist.github.com/kmdouglass/507717d339bc82f850ce"&gt;Gist website&lt;/a&gt;
where others may be more likely to find it.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;filename&lt;/span&gt;    &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;'myFile.txt'&lt;/span&gt;
&lt;span class="n"&gt;outputLines&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="c"&gt;# Keep all lines containing ANY of the following list of strings.&lt;/span&gt;
&lt;span class="n"&gt;lineFilters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;'line 1'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
	       &lt;span class="s"&gt;'line 2'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
	       &lt;span class="s"&gt;'line 3'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;stringIsIn&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;filter&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;filter&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;lineFilters&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;


&lt;span class="c"&gt;# Read only lines containing one of the strings into memory.&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;'r'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;outputLines&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stringIsIn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;))]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><category>micro-manager</category><category>python</category><guid>http://kmdouglass.github.io/posts/reading-select-lines-from-a-text-file.html</guid><pubDate>Wed, 18 Mar 2015 07:27:50 GMT</pubDate></item><item><title>The basics of virtualenv</title><link>http://kmdouglass.github.io/posts/the-basics-of-virtualenv.html</link><dc:creator>Kyle M. Douglass</dc:creator><description>&lt;p&gt;
I use Python 3.4 in most of my data analyses and in some
simulations. I like a lot of its features, like its implementation of
generators, maps, and filters. However, much of the software on my
Debian Wheezy system depends on Python 2.7 to run, such as
&lt;a href="http://www.mendeley.com/"&gt;Mendeley&lt;/a&gt;. (It used to run just fine with Python 3.4, until I ran an
automatic update and that was the end of that.)
&lt;/p&gt;

&lt;p&gt;
To run some Python 2.7 programs, I used to do the following:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;sudo rm /usr/bin/python 
sudo ln -s /usr/bin/python2.7 /usr/bin/python
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
I know. Ouch. Every single time I needed to run a program that
depended on python2.7, I would delete the symlink in /usr/bin, make a
new link to python2.7, and then run my program. When I needed to give
various programs convenient access to python3.4, I would delete the
symlink and create a new one to the newer version.
&lt;/p&gt;

&lt;p&gt;
This was dumb, because there is a convenient Python-based tool that
can fix the problem of needing multiple versions of Python (and
libraries!) on the same system. The solution to this problem is called
&lt;a href="https://virtualenv.pypa.io/en/latest/"&gt;virtualenv&lt;/a&gt;.
&lt;/p&gt;

&lt;p&gt;
There are a lot of descriptions about what virtualenv is on the
internet, so I won't bother going into details here. Instead, I will
focus on just the very basics of its setup and use so that I can have
a handy future reference for when I forget how something works and so
that others can profit from what I have learned. Most everything I've
done came from &lt;a href="http://docs.python-guide.org/en/latest/"&gt;python-guide.org&lt;/a&gt;, so I'm more-or-less putting &lt;a href="http://docs.python-guide.org/en/latest/dev/virtualenvs/"&gt;what they
have already said&lt;/a&gt; into my own words.
&lt;/p&gt;

&lt;p&gt;
To start, I already have Python 2.7 and 3.4 installed on my system. In
principle, you do not need them installed at the system level, but I
already have done this so I will start from there. I first installed
pip for Python 2.7 since I only had pip3 on my system to start. I did
this because I want to keep Python 2.7 as my system's default Python
environment.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;sudo apt-get update
sudo apt-get install python-pip
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Once installed, I used it to install virtualenv and
&lt;a href="https://virtualenvwrapper.readthedocs.org/en/latest/"&gt;virtualenvwrapper&lt;/a&gt;. The latter provides some nice features for working
with virtualenv.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;sudo pip install virtualenv
sudo pip install virtualenvwrapper
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Now, virtualenvwrapper requires an environment variable to tell it
where to store the folders for each virtual environment. This
environment variable is called WORKON_HOME. First, I created the
folder it will point to:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;mkdir ~/Envs
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Next, I edited my ~/.bashrc and added the following line:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;export &lt;/span&gt;&lt;span class="nv"&gt;WORKON_HOME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;~/Envs
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
All of my virtual environment files (except for the Python
intepreters) will be stored in this folder. Finally, I restarted my
terminal window so that the environment variable was assigned. You can
check this by typing &lt;code&gt;echo $WORKON_HOME&lt;/code&gt; in your new terminal
window. If it returns the path to your new environments folder, then
you should be fine.
&lt;/p&gt;

&lt;p&gt;
Next, I ran the virtualwrapper setup script. Note that I did not need
sudo (in fact, sudo could not find a command called ``source'') and
that no output is returned when the script is run.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;source&lt;/span&gt; /usr/local/bin/virtualenvwrapper.sh
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Now virtualenvwrapper should be installed, so let's make a virtual
environment. We can do this using the &lt;code&gt;mkvirtualenv&lt;/code&gt; command, followed
by a name for the environment. I will use the name ``venv'' in this
example, like Kenneth Reitz did in his guide that I linked above.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;mkvirtualenv venv
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
To start the new virtual environment, type &lt;code&gt;workon venv&lt;/code&gt; and note that
change in the prompt, indicating which environment you are in. You now
have a fresh Python environment to which you can add any library you
wish. To leave the environment, type &lt;code&gt;deactivate&lt;/code&gt; into your terminal.
&lt;/p&gt;

&lt;p&gt;
One simple test that you can do to see whether your Python environment
really is clean is to run the Python interpreter from inside your
environment and try importing a module that you know is in your
system-wide site packages but not in your virtual environment. For
example, inside venv I type &lt;code&gt;python&lt;/code&gt; at the terminal prompt and tried
importing numpy, which I had not yet installed in venv:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;import numpy
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This returned an &lt;b&gt;ImportError: No module named numpy&lt;/b&gt;. Since I do have
numpy installed on my system but not in this environment, it tells me
that the environment is likely clean.
&lt;/p&gt;

&lt;p&gt;
To install new libraries, simply use pip or install them to the folder
that was created for this environment in ~/Env. To delete a virtual
environment entirely, use &lt;code&gt;rmvirtual env&lt;/code&gt;.
&lt;/p&gt;

&lt;p&gt;
Now, how can I specify that I want the virtual environment to use the
python3.4 interpreter in a virtual environment named
``python3-general''? Doing so would solve my original problem. Simply
make a new virtual environment like so:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;mkvirtualenv -p /usr/bin/python3.4 python3-general
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Voilà. C'est tout. I hope this helps you get up and running with this
great tool!
&lt;/p&gt;</description><category>python</category><guid>http://kmdouglass.github.io/posts/the-basics-of-virtualenv.html</guid><pubDate>Tue, 10 Feb 2015 06:47:50 GMT</pubDate></item><item><title>Sending arguments to Python decorators</title><link>http://kmdouglass.github.io/posts/sending-arguments-to-python-decorators.html</link><dc:creator>Kyle M. Douglass</dc:creator><description>&lt;p&gt;
&lt;a href="http://simeonfranklin.com/blog/2012/jul/1/python-decorators-in-12-steps/"&gt;Python's decorators&lt;/a&gt; are tools for changing the behavior of a function
without completely recoding it. When we apply a decorator to a
function, we say that the function has been decorated. Strictly
speaking, when we decorate a function, we send it to a wrapper that
returns another function. It's as simple as that.
&lt;/p&gt;

&lt;p&gt;
I was having trouble understanding exactly to which function, the
original or the decorated one, the arguments are sent in a Python
decorated function call. I wrote the following script to better
understand this process (I use Python 3.4):
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;def wrapper(inFunction):
    def outFunction(**kwargs):
        print('The input arguments were:')
        for key, value in kwargs.items():
            print('%r : %r' % (key, value))

        # Return the original function
        return inFunction(**kwargs)

    return outFunction

def add(x = 1, y = 2):
    return x + y
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
&lt;code&gt;wrapper(inFunction)&lt;/code&gt; is a function that accepts another function as
an argument. It returns a function that simply prints the keyword
arguments of &lt;i&gt;inFunction()&lt;/i&gt;, and calls &lt;i&gt;inFunction()&lt;/i&gt; like normal.
&lt;/p&gt;

&lt;p&gt;
To decorate the function &lt;i&gt;add(x = 1, y = 2)&lt;/i&gt; so that its arguments are
printed without recoding it, we normally would place &lt;code&gt;@wrapper&lt;/code&gt; before
its definition. However, let's make the decorator in a way that's
closer to how &lt;i&gt;@&lt;/i&gt; works under the hood:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;In [22]: decoratedAdd = wrapper(add)
In [23]: decoratedAdd(x = 1, y = 24)
The input arguments were:
'y' : 24
'x' : 1
Out[23]: 25
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
When we call &lt;i&gt;decoratedAdd(x = 1, y = 24)&lt;/i&gt;, the arguments are printed
to the screen and we still get the same functionality of &lt;i&gt;add()&lt;/i&gt;. What
I wanted to know was this: are the keyword arguments x = 1, y = 24
bound in the namespace of &lt;i&gt;wrapper()&lt;/i&gt; or in the namespace of
&lt;i&gt;outFunction()&lt;/i&gt;? &lt;b&gt;In otherwords, does &lt;i&gt;wrapper()&lt;/i&gt; at any point know
what the arguments are that I send to the decorated function?&lt;/b&gt;
&lt;/p&gt;

&lt;p&gt;
The answer, as it turns out, is no in this case. This is because the
&lt;i&gt;wrapper()&lt;/i&gt; function first returns the decorated function, and then
the arguments are passed into the decorated function. If this order of
operations were flipped, &lt;i&gt;wrapper()&lt;/i&gt; should know that I set x to 1 and
y to 24, but really it doesn't know these details at all.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;In [24]: wrapper(add)(x = 1, y = 24)
The input arguments were:
'y' : 24
'x' : 1
Out[24]: 25
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
So, when I call &lt;i&gt;wrapper(add)(x = 1, y = 24)&lt;/i&gt;, first &lt;i&gt;wrapper(add)&lt;/i&gt; is
called, which returns &lt;i&gt;outFunction()&lt;/i&gt;, and then these arguments are
passed to &lt;i&gt;outFunction()&lt;/i&gt;.
&lt;/p&gt;

&lt;p&gt;
Now what happens when I call &lt;code&gt;wrapper(add(x = 1, y = 24))&lt;/code&gt;? When I try
this, the arguments are first passed into add, but then &lt;i&gt;outFunction&lt;/i&gt;
is returned without any arguments applied to it.
&lt;/p&gt;

&lt;p&gt;
This example can give us an idea about the working order of operations
in Python. Here, this example reveals that function calls in Python
are left-associative.
&lt;/p&gt;</description><category>python</category><guid>http://kmdouglass.github.io/posts/sending-arguments-to-python-decorators.html</guid><pubDate>Sat, 24 Jan 2015 07:45:38 GMT</pubDate></item><item><title>Learning Python's Multiprocessing Module</title><link>http://kmdouglass.github.io/posts/learning-pythons-multiprocessing-module.html</link><dc:creator>Kyle M. Douglass</dc:creator><description>&lt;p&gt;
I've been doing a bit of programming work lately that would greatly
benefit from a speed boost using parallel/concurrent processing
tools. Essentially, I'm doing a &lt;a href="http://www.mathworks.com/help/simulink/examples/parallel-simulations-using-parfor-parameter-sweep-in-normal-mode.html"&gt;parameter sweep&lt;/a&gt; where the values for
two different simulation parameters are input into the simulation and
allowed to run with the results being recorded to disk at the end. The
point is to find out how the simulation results vary with the
parameter values.
&lt;/p&gt;

&lt;p&gt;
In my current code, a new simulation is initialized with each pair of
parameter values inside one iteration of a for loop; each iteration of
the loop is independent of the others. Spreading these iterations over
the 12 cores on my workstation should result in about a 12x decrease
in the amount of time the simulation takes to run.
&lt;/p&gt;

&lt;p&gt;
I've had good success using the &lt;code&gt;parfor&lt;/code&gt; loop construct in Matlab in
the past, but my simulation was written in Python and I want to learn
more about Python's multiprocessing tools, so this post will explore
that module in the context of performing parameter sweeps.
&lt;/p&gt;

&lt;div id="outline-container-sec-1" class="outline-2"&gt;
&lt;h2 id="sec-1"&gt;Profile the code first to identify bottlenecks&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-1"&gt;
&lt;p&gt;
First, I profiled my code to identify where any slowdowns might be
occurring in the serial program. I used a great tutorial at the &lt;a href="https://zapier.com/engineering/profiling-python-boss/"&gt;Zapier
Engineering&lt;/a&gt; blog to write a decorator for profiling the main instance
method of my class that was doing most of the work. Surprisingly, I
found that a few numpy methods were taking the most time, namely
&lt;b&gt;norm()&lt;/b&gt; and &lt;b&gt;cross()&lt;/b&gt;. To address this, I directly imported the
Fortran BLAS &lt;b&gt;nrm2()&lt;/b&gt; function using scipy's &lt;b&gt;get_blas_funcs()&lt;/b&gt;
function and hard-coded the cross product in pure Python inside the
method; these two steps alone resulted in a 4x decrease in simulation
time. I suspect the reason for this was because the overhead of
calling functions on small arrays outweighs the increase in speed
using Numpy's optimized C code. I was normalizing single vectors and
taking cross products between two vectors at a time many times during
each loop iteration.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-2" class="outline-2"&gt;
&lt;h2 id="sec-2"&gt;A brief glance at Python's multiprocessing module&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-2"&gt;
&lt;p&gt;
&lt;a href="http://pymotw.com/2/multiprocessing/basics.html"&gt;PyMOTW&lt;/a&gt; has a good, minimal description of the main aspects of the
multiprocessing module. They state that the simplest way to create
tasks on different cores of a machine is to create new &lt;b&gt;Process&lt;/b&gt;
objects with target functions. Each object is then set to execute by
calling its &lt;b&gt;start()&lt;/b&gt; method.
&lt;/p&gt;

&lt;p&gt;
The basic example from their site looks like this:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;import multiprocessing

def worker():
    """worker function"""
    print 'Worker'
    return

if __name__ == '__main__':
    jobs = []
    for i in range(5):
        p = multiprocessing.Process(target=worker)
        jobs.append(p)
        p.start()
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
In this example, it's important to create the Process instances inside
the
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;if __name__ == '__main__':
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
section of the script because child processes import the script where
the target function is contained. Placing the object instantiation in
this section prevents an infinite, recursive string of such
instantiations. A workaround to this is to define the function in a
different script and import it into the namespace.
&lt;/p&gt;

&lt;p&gt;
To send arguments to the function (&lt;b&gt;worker()&lt;/b&gt; in the example above),
we can use the &lt;b&gt;args&lt;/b&gt; keyword in the Process object instantiation like
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;p = multiprocessing.Process(target=worker, args=(i,))
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
A very important thing to note is that the arguments must be objects
that can be pickled using Python's pickle module. If an argument is a
class instance, this means that every attritube of that class must be
pickleable.
&lt;/p&gt;

&lt;p&gt;
An important class in the multiprocessing module is a &lt;b&gt;Pool&lt;/b&gt;. A &lt;a href="https://docs.python.org/3.4/library/multiprocessing.html#multiprocessing.pool.Pool"&gt;Pool&lt;/a&gt;
object controls a pool of worker processes. Jobs can be submitted to
the Pool, which then sends the jobs to the individual workers.
&lt;/p&gt;

&lt;p&gt;
The &lt;b&gt;Pool.map()&lt;/b&gt; achieves the same functionality as Matlab's &lt;b&gt;parfor&lt;/b&gt;
construct. This method essentially applies a function to each element
in an iterable and returns the results. For example, if I wanted to
square each number in a list of integers between 0 and 9 and perform
the square operation on multiple processors, I would write a function
for squaring an argument, and supply this function and the list of
integers to &lt;b&gt;Pool.map()&lt;/b&gt;. The code looks like this:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;import multiprocessing

def funSquare(num):
    return num ** 2

if __name__ == '__main__':
    pool = multiprocessing.Pool()
    results = pool.map(funSquare, range(10))
    print(results)
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-3" class="outline-2"&gt;
&lt;h2 id="sec-3"&gt;Design the solution to the problem&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-3"&gt;
&lt;p&gt;
In my parameter sweep, I have two classes: one is an object that I'm
simulating and the other acts as a controller that sends parameters to
the structure and collects the results of the simulation. Everything
was written in a serial fashion and I want to change it so the bulk of
the work is performed in parallel.
&lt;/p&gt;

&lt;p&gt;
After the bottlenecks were identified in the serial code, I began
thinking about how the the problem of parameter sweeps could be
addressed using the multiprocessing module.
&lt;/p&gt;

&lt;p&gt;
The solution requirements I identified for my parameter sweep are as
follows:
&lt;/p&gt;

&lt;ol class="org-ol"&gt;
&lt;li&gt;Accept two values (one for each parameter) from the range of values
to test as inputs to the simulation.
&lt;/li&gt;
&lt;li&gt;For each pair of values, run the simulation as an independent
process.
&lt;/li&gt;
&lt;li&gt;Return the results of the simulation as as a list or Numpy array.
&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;
I often choose to return the results as Numpy arrays since I can
easily pickle them when saving to a disk. This may change depending on
your specific problem.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-4" class="outline-2"&gt;
&lt;h2 id="sec-4"&gt;Implementation of the solution&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-4"&gt;
&lt;p&gt;
I'll now give a simplified example of how this solution to the
parameter sweep can be implemented using Python's multiprocessing
module. I won't use objects like in my real code, but will first
demonstrate an example where &lt;b&gt;Pool.map()&lt;/b&gt; is applied to a list of
numbers.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;import multiprocessing

def runSimulation(params):
    """This is the main processing function. It will contain whatever
    code should be run on multiple processors.
    
    """
    param1, param2 = params
    # Example computation
    processedData = []
    for ctr in range(1000000):
        processedData.append(param1 * ctr - param2 ** 2)

    return processedData

if __name__ == '__main__':
    # Define the parameters to test
    param1 = range(100)
    param2 = range(2, 202, 2)

    # Zip the parameters because pool.map() takes only one iterable
    params = zip(param1, param2)
    
    pool = multiprocessing.Pool()
    results = pool.map(runSimulation, params)
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
This is a rather silly example of a simulation, but I think it
illustrates the point nicely. In the &lt;b&gt;&lt;span class="underline"&gt;&lt;span class="underline"&gt;main&lt;/span&gt;&lt;/span&gt;&lt;/b&gt; portion of the code, I
first define two lists for each parameter value that I want to
'simulate.' These parameters are zipped together in this example
because &lt;b&gt;Pool.map()&lt;/b&gt; takes only one iterable as its argument. The pool
is opened using with &lt;b&gt;multiprocessing.Pool()&lt;/b&gt;.
&lt;/p&gt;

&lt;p&gt;
Most of the work is performed in the function
&lt;b&gt;runSimulation(params)&lt;/b&gt;. It takes a tuple of two parameters which are
unpacked. Then, these parameters are used in the for loop to build a
list of simulated values which is eventually returned.
&lt;/p&gt;

&lt;p&gt;
Returning to the &lt;b&gt;&lt;span class="underline"&gt;&lt;span class="underline"&gt;main&lt;/span&gt;&lt;/span&gt;&lt;/b&gt; section, each simulation is run on a
different core of my machine using the &lt;b&gt;Pool.map()&lt;/b&gt; function. This
applies the function called &lt;b&gt;runSimulation()&lt;/b&gt; to the values in the
&lt;b&gt;params&lt;/b&gt; iterable. In other words, it calls the code described in
&lt;b&gt;runSimulation()&lt;/b&gt; with a different pair of values in params.
&lt;/p&gt;

&lt;p&gt;
All the results are eventually returned in a list in the same order as
the parameter iterable. This means that the first element in the
&lt;b&gt;results&lt;/b&gt; list corresponds to parameters of 0 and 2 in this example.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-5" class="outline-2"&gt;
&lt;h2 id="sec-5"&gt;Iterables over arbitrary objects&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-5"&gt;
&lt;p&gt;
In my real simulation code, I use a class to encapsulate a number of
structural parameters and methods for simulating a polymer model. So
long as instances of this class can be &lt;a href="https://docs.python.org/3/library/pickle.html"&gt;pickled&lt;/a&gt;, I can use them as the
iterable in &lt;b&gt;Pool.map()&lt;/b&gt;, not just lists of floating point numbers.
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;import multiprocessing

class simObject():
    def __init__(self, params):
        self.param1, self.param2 = params

def runSimulation(objInstance):
    """This is the main processing function. It will contain whatever
    code should be run on multiple processors.
    
    """
    param1, param2 = objInstance.param1, objInstance.param2
    # Example computation
    processedData = []
    for ctr in range(1000000):
        processedData.append(param1 * ctr - param2 ** 2)

    return processedData

if __name__ == '__main__':
    # Define the parameters to test
    param1 = range(100)
    param2 = range(2, 202, 2)

    objList = []
    # Create a list of objects to feed into pool.map()
    for p1, p2 in zip(param1, param2):
        objList.append(simObject((p1, p2)))

    pool = multiprocessing.Pool()
    results = pool.map(runSimulation, objList)
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
Again, this is a silly example, but it demonstrates that lists of
objects can be used in the parameter sweep, allowing for easy
parallelization of object-oriented code.
&lt;/p&gt;

&lt;p&gt;
Instead of &lt;b&gt;runSimulation()&lt;/b&gt;, you may want to apply an instance method
to a list in &lt;b&gt;pool.map()&lt;/b&gt;. A naïve way to do this is to replace
&lt;b&gt;runSimulation&lt;/b&gt; with with the method name but this too causes
problems. I won't go into the details here, but one solution is to use
an instance's &lt;b&gt;__call__()&lt;/b&gt; method and pass the object instance into
the pool. More details can be found &lt;a href="http://stackoverflow.com/questions/1816958/cant-pickle-type-instancemethod-when-using-pythons-multiprocessing-pool-ma"&gt;here&lt;/a&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-6" class="outline-2"&gt;
&lt;h2 id="sec-6"&gt;Comparing computation times&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-6"&gt;
&lt;p&gt;
The following code makes a rough comparison between computation time
for the parallel and serial versions of &lt;b&gt;map()&lt;/b&gt;:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;import multiprocessing
import time

def runSimulation(params):
    """This is the main processing function. It will contain whatever
    code should be run on multiple processors.
    
    """
    param1, param2 = params
    # Example computation
    processedData = []
    for ctr in range(1000000):
        processedData.append(param1 * ctr - param2 ** 2)

    return processedData

if __name__ == '__main__':
    # Define the parameters to test
    param1 = range(100)
    param2 = range(2, 202, 2)

    params = zip(param1, param2)

    pool = multiprocessing.Pool()

    # Parallel map
    tic = time.time()
    results = pool.map(runSimulation, params)
    toc = time.time()

    # Serial map
    tic2 = time.time()
    results = map(runSimulation, params)
    toc2 = time.time()

    print('Parallel processing time: %r\nSerial processing time: %r'
          % (toc - tic, toc2 - tic2))
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;
On my machine, &lt;b&gt;pool.map()&lt;/b&gt; ran in 9.6 seconds, but the serial version
took 163.3 seconds. My laptop has 8 cores, so I would have expected
the speedup to be a factor of 8, not a factor of 16. I'm not sure why
it's 16, but I suspect part of the reason is that measuring system
time using the &lt;b&gt;time.time()&lt;/b&gt; function is not wholly accurate.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-7" class="outline-2"&gt;
&lt;h2 id="sec-7"&gt;Important points&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-7"&gt;
&lt;p&gt;
I can verify that all the cores are being utilized on my machine while
the code is running by using the &lt;a href="http://hisham.hm/htop/"&gt;htop&lt;/a&gt; console program. In some cases,
Python modules like Numpy, scipy, etc. may limit processes in Python
to running on only one core on Linux machines, which defeats the
purpose of writing concurrent code in this case. (See for example &lt;a href="http://stackoverflow.com/questions/15639779/what-determines-whether-different-python-processes-are-assigned-to-the-same-or-d/15641148#15641148"&gt;this
discussion&lt;/a&gt;.) To fix this, we can import Python's &lt;b&gt;os&lt;/b&gt; module to reset
the task affinity in our code:
&lt;/p&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;os.system("taskset -p 0xff %d" % os.getpid())
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div id="outline-container-sec-8" class="outline-2"&gt;
&lt;h2 id="sec-8"&gt;Conclusions&lt;/h2&gt;
&lt;div class="outline-text-2" id="text-8"&gt;
&lt;p&gt;
I think that Matlab's &lt;b&gt;parfor&lt;/b&gt; construct is easier to use because one
doesn't have to consider the nuances of writing concurrent code. So
long as each loop iteration is independent of the others, you simply
write a &lt;b&gt;parfor&lt;/b&gt; instead of &lt;b&gt;for&lt;/b&gt; and you're set.
&lt;/p&gt;

&lt;p&gt;
In Python, you have to prevent infinite, recursive function calls by
placing your code in the &lt;b&gt;&lt;span class="underline"&gt;&lt;span class="underline"&gt;main&lt;/span&gt;&lt;/span&gt;&lt;/b&gt; section of your script or by
placing the function in a different script and importing it. You also
have to be sure that Numpy and other Python modules that use BLAS
haven't reset the core affinity. What you gain over Matlab's
implementation is the power of using Python as a general programming
language with a lot of tools for scientific computing. This and the
multiprocessing module is free; you have to have an institute license
or pay for Matlab's &lt;a href="http://www.mathworks.com/products/parallel-computing/"&gt;Parallel Computing Toolbox&lt;/a&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description><category>computing</category><category>python</category><guid>http://kmdouglass.github.io/posts/learning-pythons-multiprocessing-module.html</guid><pubDate>Mon, 29 Dec 2014 17:42:23 GMT</pubDate></item></channel></rss>