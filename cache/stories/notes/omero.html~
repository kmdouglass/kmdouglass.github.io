<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. The Open Microscopy Environment - OMERO</a></li>
<li><a href="#sec-2">2. OMERO Virtual Appliance</a>
<ul>
<li><a href="#sec-2-1">2.1. Setup 1</a>
<ul>
<li><a href="#sec-2-1-1">2.1.1. My computer system</a></li>
<li><a href="#sec-2-1-2">2.1.2. Directions for Installing the OMERO Virtual Appliance</a></li>
<li><a href="#sec-2-1-3">2.1.3. Problem: Loading and booting the virtual appliance</a></li>
<li><a href="#sec-2-1-4">2.1.4. Solution: Enabled Virtualization Support in the BIOS</a></li>
</ul>
</li>
<li><a href="#sec-2-2">2.2. Setup 2</a>
<ul>
<li><a href="#sec-2-2-1">2.2.1. Problem: The OMERO Virtual Appliance hangs after half an hour</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">3. OMERO Test Server Installation</a>
<ul>
<li><a href="#sec-3-1">3.1. Hardware</a></li>
<li><a href="#sec-3-2">3.2. Software prequisites</a>
<ul>
<li><a href="#sec-3-2-1">3.2.1. Java SE Development Kit (JDK) 7u51</a></li>
<li><a href="#sec-3-2-2">3.2.2. Python 2.6.6</a></li>
<li><a href="#sec-3-2-3">3.2.3. Coffee</a></li>
<li><a href="#sec-3-2-4">3.2.4. Ice 3.4.2</a></li>
<li><a href="#sec-3-2-5">3.2.5. PostgreSQL 9.3.3</a></li>
<li><a href="#sec-3-2-6">3.2.6. Setting up the environment variables</a></li>
<li><a href="#sec-3-2-7">3.2.7. Computer restart</a></li>
<li><a href="#sec-3-2-8">3.2.8. Database creation</a></li>
</ul>
</li>
<li><a href="#sec-3-3">3.3. OMERO.server software installation</a>
<ul>
<li><a href="#sec-3-3-1">3.3.1. Initial problems with the omero batch file and Python 2.7</a></li>
<li><a href="#sec-3-3-2">3.3.2. Second install attempt with Python 2.6</a></li>
<li><a href="#sec-3-3-3">3.3.3. Fixing issues with Java and PostgreSQL not being on your path</a></li>
<li><a href="#sec-3-3-4">3.3.4. Generating the SQL initialization script</a></li>
<li><a href="#sec-3-3-5">3.3.5. Database initialization</a></li>
<li><a href="#sec-3-3-6">3.3.6. Error when starting the server and solution</a></li>
<li><a href="#sec-3-3-7">3.3.7. Logging in for the first time</a></li>
<li><a href="#sec-3-3-8">3.3.8. Increasing the Java Virtual Machine memory</a></li>
<li><a href="#sec-3-3-9">3.3.9. OMERO.web and administration</a></li>
</ul>
</li>
<li><a href="#sec-3-4">3.4. Summary of software installation</a></li>
</ul>
</li>
<li><a href="#sec-4">4. OMERO Test Server Maintenance</a>
<ul>
<li><a href="#sec-4-1">4.1. Run the OMERO server in the background</a></li>
<li><a href="#sec-4-2">4.2. Deploying OMERO.web on IIS</a>
<ul>
<li><a href="#sec-4-2-1">4.2.1. Summary of IIS web deployment</a></li>
</ul>
</li>
<li><a href="#sec-4-3">4.3. Setting up routine backups</a></li>
<li><a href="#sec-4-4">4.4. Notes on security</a></li>
<li><a href="#sec-4-5">4.5. DropBox</a></li>
<li><a href="#sec-4-6">4.6. Summary of Test Server Maintenance</a></li>
</ul>
</li>
<li><a href="#sec-5">5. OMERO Server Installation</a>
<ul>
<li><a href="#sec-5-1">5.1. Server Specs</a></li>
<li><a href="#sec-5-2">5.2. Pre-installation</a>
<ul>
<li><a href="#sec-5-2-1">5.2.1. Turn off Windows Installer RDS Compatibility</a></li>
</ul>
</li>
<li><a href="#sec-5-3">5.3. Software</a></li>
<li><a href="#sec-5-4">5.4. Differences from test server installation</a></li>
</ul>
</li>
<li><a href="#sec-6">6. OMERO Server Administration</a>
<ul>
<li><a href="#sec-6-1">6.1. Group and User Creation</a></li>
<li><a href="#sec-6-2">6.2. Requirements for OMERO.movie</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> The Open Microscopy Environment - OMERO</h2>
<div class="outline-text-2" id="text-1">
<p>
I have been dabbling with the <a href="http://www.openmicroscopy.org/site">Open Microscopy Environment</a>, a suite
of open-source software for the storage and manipulation of
microscopy data.
</p>

<p>
I'm especially interested in OMERO, which provides client-server
software for image storage and handling of metadata. I'm interested
in this because I believe that it could improve our lab's data
provenance, i.e. the record-keeping that describes how our results
are derived from our raw data. This is extremely important, yet
extremely difficult to achieve when working with the enormous data
sets that we normally do.
</p>

<p>
On this page I've maintained notes on my attempts to setup a working
OMERO server.
</p>
<hr  />
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> OMERO Virtual Appliance</h2>
<div class="outline-text-2" id="text-2">
<p>
The OMERO virtual appliance is a virtual system that allows you to
experiment with the OMERO server before actually installing
one. This sounds nice, but is proving to be a bit tricky to get
working.
</p>
<hr  />
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Setup 1</h3>
<div class="outline-text-3" id="text-2-1">
<p>
This section describes my first attempt to setup the OMERO Virtual
Appliance.
</p>
<hr  />
</div>

<div id="outline-container-sec-2-1-1" class="outline-4">
<h4 id="sec-2-1-1"><span class="section-number-4">2.1.1</span> My computer system</h4>
<div class="outline-text-4" id="text-2-1-1">
<ul class="org-ul">
<li>Dell Precision T7500
</li>
<li>Windows Server 2008 R2 Enterprise w/Service Pack 1, 64 bit
</li>
<li>Intel Xeon X5690 @ 3.47 GHz (2 processors)
</li>
<li>48.0 GB RAM
</li>
</ul>

<hr  />
</div>
</div>
<div id="outline-container-sec-2-1-2" class="outline-4">
<h4 id="sec-2-1-2"><span class="section-number-4">2.1.2</span> Directions for Installing the OMERO Virtual Appliance</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
I followed the directions on OMERO's webpage for this process
(<a href="https://www.openmicroscopy.org/site/support/omero4/users/virtual-appliance.html">https://www.openmicroscopy.org/site/support/omero4/users/virtual-appliance.html</a>).
</p>

<p>
<span class="underline">Software versions</span>
</p>
<ul class="org-ul">
<li>VirtualBox version 4.3.8 r92456 for Windows (VirtualBox-4.3.8-92456Win)
</li>
<li>OMERO Virtual Appliance version 5.0.0-b19
(OMERO.vm-5.0.0-b19.ova)
</li>
</ul>

<p>
During the VirtualBox install I accepted all the defaults. This
caused no problems.
</p>

<p>
I also loaded the virtual appliance into Virtual Box and verified
that Port Forwarding was setup as required. It was.
</p>
<hr  />
</div>
</div>
<div id="outline-container-sec-2-1-3" class="outline-4">
<h4 id="sec-2-1-3"><span class="section-number-4">2.1.3</span> Problem: Loading and booting the virtual appliance</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
I attempted to boot the virtual appliance as it is described in
the OMERO documentation. After powering on the virtual machine, I
see the following screens, in this order:
</p>

<ol class="org-ol">
<li>The Oracle/VirtualBox splash screen.
</li>
<li>A black window with the lines "Grub loading." and "Welcome to
GRUB!". The second line appears roughly two seconds after the
first appears.
</li>
<li>A new window with the line "Booting 'Debian GNU/Linux, with
Linux 3.2.0-4-amd64'" at top. The lines "Loading Linux
3.2.0-4-amd64 &#x2026;" and "Loading initial ramdisk &#x2026;" appear
after this sequentially.
</li>
</ol>

<p>
Unfortunately, at this point, the virtual machine screen goes
black with only a non-blinking cursor. I let the machine sit for
about half an hour and saw no change from this screen. I also
could not log onto the OMERO.web interface. or with the
OMERO.insight client.
</p>


<div class="figure">
<p><img src="../../images/ome/setup1-vbScreen.jpg" alt="setup1-vbScreen.jpg" />
</p>
</div>
<a href="/img/ome/setup1-vbScreen.jpg">
  <img class="standard-img" src="/img/ome/setup1-vbScreen.jpg" alt="The VirtualBox screen immediately before it goes blank in Setup 1.">
</a>

<hr  />
</div>
</div>
<div id="outline-container-sec-2-1-4" class="outline-4">
<h4 id="sec-2-1-4"><span class="section-number-4">2.1.4</span> Solution: Enabled Virtualization Support in the BIOS</h4>
<div class="outline-text-4" id="text-2-1-4">
<p>
I solved the above problem by enabling virtualization support in
my computer's BIOS. (I don't know why this works. I need to read
about it.) To do this on my Dell T7500, I followed the following
steps:
</p>

<ol class="org-ol">
<li>Restart my computer, press at the splash screen, and enter the
system configuration tool
</li>
<li>Select the "Virtualization Support" folder on the left side of
the screen.
</li>
<li>Select the "Virtualization" tab.
</li>
<li>Check the box labeled "Enable Intel Virtualization Technology".
</li>
<li>Select the "VT for Direction I/O" tab.
</li>
<li>Check "Enable Intel VT for Direct I/O."
</li>
</ol>

<p>
Save the settings and restart the computer. The OMERO Virtual
Appliance should now run in VirtualBox.
</p>

<hr  />
</div>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Setup 2</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Setup 2 is essentially the same as Setup 1 but with the
virtualization settings enabled in the BIOS.
</p>

<hr  />
</div>

<div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1"><span class="section-number-4">2.2.1</span> Problem: The OMERO Virtual Appliance hangs after half an hour</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
After testing the Virtual Appliance for roughly half an hour I
suddently lost connection to the server in the OMERO.insight
client.
</p>

<p>
I ALT-TABed to the appliance's terminal window to see that it had
resumed, the blank, hanging state indicative of the problem I
encountered in <i>Setup 1</i>.
</p>

<p>
I should perhaps allocate more memory to the Virtual Appliance in
Virtual Box.
</p>

<hr  />
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> OMERO Test Server Installation</h2>
<div class="outline-text-2" id="text-3">
<p>
Before installing the OMERO on our dedicated server, I would like to
walk through the installation on a different machine running Windows
Server 2008. This is a desktop machine that I also use as a work
station, but it should emulate well any problems I might encounter
with the actual OMERO install.
</p>

<p>
I will be following the OMERO.server Windows Installation guide found here:
<a href="https://www.openmicroscopy.org/site/support/omero5/sysadmins/windows/server-installation.html">https://www.openmicroscopy.org/site/support/omero5/sysadmins/windows/server-installation.html</a>
</p>

<hr  />
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Hardware</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The hardware for this test machine is described in the section <i>My
computer system</i> above. It is the same system that I ran the virtual
appliance on.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Software prequisites</h3>
<div class="outline-text-3" id="text-3-2">
<p>
According to the installation guide, I need to download and install
the following software. All software should be 32 bit or 64 bit,
i.e. I should not mix and match. Also, I initially had Python (x,y)
2.7.5 installed. Before attempting the OMERO.server prequisites, I
uninstalled it from my computer.
</p>

<p>
I installed the following software in the order found in this
list. For some reason, Ice is discussed before the installation of
Python in the OMERO.server documentation, but it requires
Python. Therefore, I chose to install it after Python.
</p>

<ol class="org-ol">
<li><span class="underline">Java SE Development Kit</span> (JDK) &#x2013; JDK 6 and above are supported.
</li>
<li><span class="underline">Python</span> 2.6 (not 2.7 or later!) &#x2013; 64 bit Python has not been
fully tested, though it should work. Ice in Windows won't work
with Python 2.7.
</li>
<li><span class="underline">Python for Windows extensions</span> (PyWin32) &#x2013; Check the
OMERO.server installation guide for the proper version.
</li>
<li><span class="underline">Additional Python libraries</span> &#x2013; See the OMERO.server
installtion guide.
</li>
<li><span class="underline">Ice</span> (3.3.x or 3.4.x) &#x2013; Ice 3.5 is not supported in the Windows
install.
</li>
<li><span class="underline">PostgreSQL</span> 8.4 (or later)
</li>
</ol>

<hr  />
</div>

<div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1"><span class="section-number-4">3.2.1</span> Java SE Development Kit (JDK) 7u51</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
I installed JDK 7u51 for 64 bit Windows. The download link for
jdk-7u51-windows-x64.exe is here:
<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>
</p>


<p>
I accepted all default options, including installing it to
<i>C:\Program Files\Java\jdk1.7.0_51</i>.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-2-2" class="outline-4">
<h4 id="sec-3-2-2"><span class="section-number-4">3.2.2</span> Python 2.6.6</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
Python, besides being my choice scripting language, is also
required for Ice to work (see <i>Ice 3.4.2</i>). I wanted to start fresh
like I would be doing on the actual server, so I uninstalled my
Python(x,y) package. I then downloaded the 64 bit Windows
pre-compiled binary for Python 2.6.6 from <a href="https://www.python.org/download/releases/2.6.6/">https://www.python.org/download/releases/2.6.6/</a>
and installed it. The file name is <i>python-2.6.6.amd64.msi</i>.
</p>

<hr  />
</div>

<ol class="org-ol"><li>Python for Windows Build 218<br  /><div class="outline-text-5" id="text-3-2-2-1">
<p>
I downloaded and installed <i>pywin32-218.5.win-amd64-py2.6.exe</i> from
<a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/">http://www.lfd.uci.edu/~gohlke/pythonlibs/</a>.
</p>

<hr  />
</div>
</li>
<li>Edit the environment variables<br  /><div class="outline-text-5" id="text-3-2-2-2">
<p>
At this point, I edited my <b>System</b> Path environment variable. I
added "C:\Python26" to the beginning of the variable.
</p>

<p>
To edit it, I right-clicked on <i>Computer</i> from the Start Menu and
selected <i>Properties</i>&#x2026; In this menu, I selected <i>Advanced
system settings</i> from this menu. Under the <i>Advanced</i> tab, I
clicked the button labeled <i>Environment Variables&#x2026;</i> and edited
the <b>System</b> variable. Make sure that you don't edit the <b>User</b>
variable.
</p>

<hr  />
</div>
</li>
<li>pip 1.5.4<br  /><div class="outline-text-5" id="text-3-2-2-3">
<p>
I nexted installed pip 1.5.4, the Python package index. (Pillow
is easily installed with pip, and I will likely use pip in the
future anyway.) To do this, I downloaded <i>get-pip.py</i> from
<a href="http://www.pip-installer.org/en/latest/installing.html">http://www.pip-installer.org/en/latest/installing.html</a>.
</p>

<p>
I navigated to the directory where I downloaded the file in the
Windows command prompt and executed the command <i>python
get-pip.py</i>
</p>

<hr  />
</div>
</li>
<li>(OLD) Fixing non-ascii encoding errors in Python 2.7<br  /><div class="outline-text-5" id="text-3-2-2-4">
<p>
<b><b><b>NOTE</b></b></b> I performed this step only during my first
installation when I attempted to install OMERO with Python
2.7. Since ICE can't use Python 2.7, and mimetypes.py is
different in Python 2.6, this step isn't necessary when using
Python 2.6.
</p>

<p>
I work in
    French-speaking Switzerland, which means the registry on my
    Windows workstation often contains characters that are not found
    in the ascii encoding. This became apparent when I attempted to
    install Pillow using pip. pip's <i>easy_install.py</i> script threw an
    error when accessing <i>mimetypes.py</i> in the Python library. This
    bug is documented here: <a href="http://bugs.python.org/issue16617">http://bugs.python.org/issue16617</a>
</p>

<ol class="org-ol">
<li>Install GnuWin Patch 2.5.9 from here
        <a href="http://gnuwin32.sourceforge.net/packages/patch.htm">http://gnuwin32.sourceforge.net/packages/patch.htm</a>.
</li>
<li>Download the <i>mimetypes.patch</i> file from the Python bug report
mentioned above. Place it in the same directory as
<i>mimetypes.py</i>. For me, this was <i>C:\Python27\Lib\</i>.
</li>
<li>Move the patch file into the same directory as <i>mimetypes.py</i>.
</li>
<li>In a command prompt with root privileges, run the command
        <i>patch &lt; mimetypes.patch</i>.
<ol class="org-ol">
<li>Note that I needed to add the directory containing the
patch binary file to my environment variables. This was
<i>C:\Program Files (x86)\GnuWin32\bin</i>.
</li>
<li>Note that the patch changes two lines in <i>mimetypes.py</i>,
but the second line that the patch refers to in
<i>mimetypes.py</i> in my install is wrong. I manually changed
line 272 (not 270!) from <i>except UnicodeEncodeError:</i> to
<i>except UnicodeError</i>.
</li>
</ol>
</li>
</ol>

<hr  />
</div>
</li>
<li>Pillow 2.3.1<br  /><div class="outline-text-5" id="text-3-2-2-5">
<p>
<i>Pillow-2.3.1.zip</i> from <a href="https://pypi.python.org/pypi/Pillow/2.3.1">https://pypi.python.org/pypi/Pillow/2.3.1</a>
</p>

<p>
To install Pillow on this Windows machine, I followed these
directions:
<a href="http://pillow.readthedocs.org/en/latest/installation.html#windows-installation">http://pillow.readthedocs.org/en/latest/installation.html#windows-installation</a>.
</p>


<p>
In brief, I opened a command prompt with administrator privileges
and switched to the directory containing the pip binaries.For me
the directory is <i>C:\Python26\Scripts</i>. I ran the command
<i>easy_install Pillow</i>.
</p>

<p>
This originally throws an error about a missing file called
<i>vcvarsall.bat</i> because I have Visual Studio 2012 installed (not
2008). I changed the VS90COMNTOOLS environment variable by
running the command <i>set VS90COMNTOOLS=%VS110COMNTOOLS%</i>. See
<a href="http://stackoverflow.com/questions/2817869/error-unable-to-find-vcvarsall-bat">http://stackoverflow.com/questions/2817869/error-unable-to-find-vcvarsall-bat</a>.
</p>

<p>
My next attempt to install Pillow produced the error: 
</p>

<div class="highlight"><pre><span class="n">build</span>\<span class="n">temp</span><span class="o">.</span><span class="n">win</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="mf">2.6</span>\<span class="n">Release</span>\<span class="n">_imaging</span><span class="o">.</span><span class="n">pyd</span><span class="o">.</span><span class="n">manifest</span> <span class="p">:</span> <span class="n">general</span>
<span class="n">error</span> <span class="n">c1010070</span><span class="p">:</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">load</span> <span class="ow">and</span> <span class="n">Parse</span> <span class="n">the</span> <span class="n">manifest</span><span class="o">.</span> <span class="n">The</span> <span class="n">system</span>
<span class="n">cannot</span> <span class="n">find</span> <span class="n">the</span> <span class="nb">file</span> <span class="n">specified</span><span class="o">./</span>
</pre></div>

<p>
This issue is addressed here:
<a href="http://stackoverflow.com/questions/12418735/pip-fails-to-install-pil-or-pillow-with-mt-exe-error">http://stackoverflow.com/questions/12418735/pip-fails-to-install-pil-or-pillow-with-mt-exe-error</a>
and here: <a href="http://bugs.python.org/issue4431">http://bugs.python.org/issue4431</a>. I fixed it by adding
<i>ld_args.append('/MANIFEST')</i> to below the line
<i>ld_args.append('/MANIFESTFILE:' + temp_manifest)</i> in
<i>msvc9compiler.py</i>, which is found in
<i>C:\Python26\Lib\disutils\</i>.
</p>

<p>
Pillow succesfully installed after this.
</p>

<hr  />
</div>
</li>
<li>Numpy1.8.0, Scipy-0.14.0b1, and matplotlib 1.3.1<br  /><div class="outline-text-5" id="text-3-2-2-6">
<p>
Because I installed 64 bit Python, I needed to download and
install the unofficial 64 bit binaries of Numpy and Scipy found
at the links below.
</p>

<ul class="org-ul">
<li><i>numpy-MKL-1.8.1rc1.amd64-py2.6.exe</i> from <a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy">http://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy</a>
</li>
<li><i>scipy-0.13.3.win-amd64-py2.6.exe</i> from <a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#scipy">http://www.lfd.uci.edu/~gohlke/pythonlibs/#scipy</a>
</li>
<li><i>matplotlib-1.3.1.win-amd64-py2.6.exe</i> from <a href="http://matplotlib.org/downloads.html">http://matplotlib.org/downloads.html</a>
</li>
</ul>

<p>
I installed the packages in the above list in top-to-bottom
order.
</p>

<hr  />
</div>
</li>
<li>numexpr 2.1, Cython 0.20.1, HDF4 1.8.12, and PyTables 3.1<br  /><div class="outline-text-5" id="text-3-2-2-7">
<p>
I attempted to install PyTables 3.1 using pip via the command
<i>easy_install tables</i>, but I received an error informing me that
I needed numexpr 2.0.0 or greater.
</p>

<p>
I downloaded <i>numexpr-2.3.1.win-amd64-py2.6.exe</i> from
<a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#numexpr">http://www.lfd.uci.edu/~gohlke/pythonlibs/#numexpr</a> and installed
numexpr. For some reason the pip package wouldn't install.
</p>

<p>
Next, I executed <i>easy_install numexpr</i>, which added numexpr 2.1
to the <i>easy-install.pth</i> file. However, PyTables now needed
Cython, so I executed the command <i>pip install Cython</i> to install
Cython (version 0.20.1 as of March 19, 2014).
</p>

<p>
Following this, I learned that an HDF5 install is ALSO required
for PyTables. (Managing package dependencies on Windows sucks.)
So I downloaded <i>hdf5-1.8.12-win64-vs10shared.zip</i> from
<a href="http://www.hdfgroup.org/HDF5/release/obtain5.html">http://www.hdfgroup.org/HDF5/release/obtain5.html</a>, unzipped it,
and ran the executable it contained. Be sure to add HDF5 to the
PATH for all users during the install.
</p>

<p>
This unfortunately didn't fix the problem of the unrecognized
HDF5 library, even when I added the HDF5 directory to the
HDF5_DIR environment variable. However, I learned that the
PyTables binaries come prepackaged with the required HDF5 dll's;
I only need to install numexpr and Cython. I learned this here:
<a href="http://pytables.github.io/usersguide/installation.html#binaryinstallationdescr">http://pytables.github.io/usersguide/installation.html#binaryinstallationdescr</a>
</p>

<p>
So, I downloaded <i>tables-3.1.0.win-amd64-py2.6.exe</i> from
<a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#pytables">http://www.lfd.uci.edu/~gohlke/pythonlibs/#pytables</a> and ran
it. Beautiful.
</p>

<p>
Finally, I enabled LZO compression in PyTables because they
mentioned that it may speed up some operations. I downloaded
<i>lzo-2.03-win64.zip</i> from
<a href="http://sourceforge.net/projects/pytables/files/lzo-win/">http://sourceforge.net/projects/pytables/files/lzo-win/</a>. I copied
<i>lzo2.dll</i> found within it to <i>C:\Windows\System32</i>.
</p>

<p>
Inside the Python shell, I ran the following commands:
</p>

<div class="highlight"><pre><span class="kn">import</span> <span class="nn">tables</span>
<span class="n">tables</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>

<p>
After 223.588 seconds, the test stopped and reported that I had a
working copy of PyTables.
</p>

<hr  />
</div>
</li></ol>
</div>
<div id="outline-container-sec-3-2-3" class="outline-4">
<h4 id="sec-3-2-3"><span class="section-number-4">3.2.3</span> Coffee</h4>
<div class="outline-text-4" id="text-3-2-3">
<p>
At this point I went to get coffee.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-2-4" class="outline-4">
<h4 id="sec-3-2-4"><span class="section-number-4">3.2.4</span> Ice 3.4.2</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
Ice 3.5.0 does not work with an OMERO Windows install. Instead, I
downloaded and installed Ice 3.4.2 from
<a href="http://zeroc.com/download_3_4_2.html">http://zeroc.com/download_3_4_2.html</a>. The file name is
<i>Ice-3.4.2.msi</i>.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-2-5" class="outline-4">
<h4 id="sec-3-2-5"><span class="section-number-4">3.2.5</span> PostgreSQL 9.3.3</h4>
<div class="outline-text-4" id="text-3-2-5">
<p>
I downloaded the <i>postgresql-9.3.3-1-windows-x64.exe</i> from
<a href="http://www.enterprisedb.com/products-services-training/pgdownload#windows">http://www.enterprisedb.com/products-services-training/pgdownload#windows</a>.
</p>

<p>
During the graphical install I set a super-user password and
selected the default port of 5432. I set the locale to US English
since my lab works in English, despite being located in
French-speaking Switzerland.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-2-6" class="outline-4">
<h4 id="sec-3-2-6"><span class="section-number-4">3.2.6</span> Setting up the environment variables</h4>
<div class="outline-text-4" id="text-3-2-6">
<p>
I followed the OMERO install guide's directions for setting the
environment variables. Specifically, I
</p>

<ul class="org-ul">
<li>added "C:\Program Files (x86)\ZeroC\Ice-3.4.2\bin\x64" to the end of
the System PATH variable;
</li>
<li>created a new system environment variable called PYTHONPATH and
set its value to "C:\Program Files
(x86)\ZeroC\Ice-3.4.2\python\x64".
</li>
</ul>

<p>
Be sure to use the "x64" folders if you've been installing 64 bit
programs!
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-2-7" class="outline-4">
<h4 id="sec-3-2-7"><span class="section-number-4">3.2.7</span> Computer restart</h4>
<div class="outline-text-4" id="text-3-2-7">
<p>
At this point, at the recommendation of the OMERO install guide, I
restarted the computer.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-2-8" class="outline-4">
<h4 id="sec-3-2-8"><span class="section-number-4">3.2.8</span> Database creation</h4>
<div class="outline-text-4" id="text-3-2-8">
<p>
I followed the steps in the OMERO installation guide exactly to
create a database using postgre's pgAdmin III program.
</p>

<hr  />
</div>
</div>
</div>
<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> OMERO.server software installation</h3>
<div class="outline-text-3" id="text-3-3">
<p>
I downloaded the Ice 3.4 Server from OMERO's downloads section,
found here: <a href="http://downloads.openmicroscopy.org/omero/5.0.0/">http://downloads.openmicroscopy.org/omero/5.0.0/</a>
</p>

<p>
I downloaded the 3.4 version because 3.5 does not yet work on a
Windows install due to incompatibility with Python 3.
</p>

<hr  />
</div>

<div id="outline-container-sec-3-3-1" class="outline-4">
<h4 id="sec-3-3-1"><span class="section-number-4">3.3.1</span> Initial problems with the omero batch file and Python 2.7</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
The default install directory for Ice was in <i>C:\Program Files
(x86)</i>. Unfortunately, this creates issues in the batch file
<i>setpythonpath.bat</i> that's called by the <i>omero.bat</i> script.
</p>

<p>
To fix it, I placed double quotes around %PYTHONPATH% and %%i
after PARSE on line 11 of <i>setpythonpath.bat</i>.
</p>

<p>
However, I then received a notice that the OMERO configuration
could not find a dll with the OMERO.cli module. According to the
OMERO troubleshooting page
(<a href="https://www.openmicroscopy.org/site/support/omero5/sysadmins/troubleshooting.html">https://www.openmicroscopy.org/site/support/omero5/sysadmins/troubleshooting.html</a>),
this usually occurs when there are issues with PYTHONPATH.
</p>

<p>
I wondered if the issue could be with the spaces in <i>C:\Program
Files (x86)</i>, so I uninstalled Ice and reinstalled it to
<i>C:\ZeroC\Ice-3.4.2</i>. I updated the appropriate environment
variables to reflect this change and tried the install again.
</p>

<p>
Installing to a directory without spaces fixed the batch file
errors, but the configuration file still cannot find OMERO.cli.
</p>

<hr  />
</div>
<ol class="org-ol"><li>Ice requires Python 2.6<br  /><div class="outline-text-5" id="text-3-3-1-1">
<p>
After asking on the forum, I discovered that Ice 3.4 requires
Python 2.6, NOT Python 2.7. This is presumably causing the issues
with the missing DLL. I misread the OMERO install documentation,
which read Python 2 (2.6 or later). The forum discusssion is
here:
<a href="https://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7466">https://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7466</a>
</p>

<p>
I updated all the preceding notes to reflect a Python 2.6
installation.
</p>

<hr  />
</div>
</li></ol>
</div>
<div id="outline-container-sec-3-3-2" class="outline-4">
<h4 id="sec-3-3-2"><span class="section-number-4">3.3.2</span> Second install attempt with Python 2.6</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
Once I reinstalled all the prereqs associated with Python 2.6, I
opened a command prompt with administrator rights and navigated to
<i>C:\OMERO.server</i>. I unzipped the OMERO server files into this
directory. I also created an empty directory named <i>C:\OMERO</i>.
</p>

<p>
In the prompt I entered the following commands, with <i>MYUSER</i> and
<i>MYPASS</i> replaced with the appropriate information.
</p>

<div class="highlight"><pre>bin<span class="se">\o</span>mero config <span class="nb">set </span>omero.db.name omero_database
bin<span class="se">\o</span>mero config <span class="nb">set </span>omero.db.user MYUSER
bin<span class="se">\o</span>mero config <span class="nb">set </span>omero.db.pass MYPASS
bin<span class="se">\o</span>mero config <span class="nb">set </span>omero.data.dir C:<span class="se">\\</span>OMERO
</pre></div>

<p>
This time the script ran without any output, as opposed to the
OMERO.cli errors I received when I attempted to configure OMERO
with Python 2.7 installed.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-3-3" class="outline-4">
<h4 id="sec-3-3-3"><span class="section-number-4">3.3.3</span> Fixing issues with Java and PostgreSQL not being on your path</h4>
<div class="outline-text-4" id="text-3-3-3">
<p>
I next entered the following commands in a command prompt with
administrator privileges. My goal was to create the database
initialization script, but the command returned the following
error concerning Java.
</p>

<div class="highlight"><pre>C:\Windows\system32&amp;gt;cd C:\OMERO.server

C:\OMERO.server&amp;gt;bin\omero db script
Traceback (most recent call last):
  File &quot;C:\OMERO.server\bin\\omero&quot;, line 125, in &amp;lt;module&amp;gt;
    rv = omero.cli.argv()
  File &quot;C:\OMERO.server\lib\python\omero\cli.py&quot;, line 1195, in argv
    cli.invoke(args[1:])
  File &quot;C:\OMERO.server\lib\python\omero\cli.py&quot;, line 745, in invoke
    stop = self.onecmd(line, previous_args)
  File &quot;C:\OMERO.server\lib\python\omero\cli.py&quot;, line 814, in onecmd
    self.execute(line, previous_args)
  File &quot;C:\OMERO.server\lib\python\omero\cli.py&quot;, line 894, in execute
    args.func(args)
  File &quot;C:\OMERO.server\lib\python\omero\plugins\db.py&quot;, line 258, in script
    data = self.ctx.initData({})
  File &quot;C:\OMERO.server\lib\python\omero\cli.py&quot;, line 1018, in initData
    output = getprefs([&quot;get&quot;], str(path(self._cwd(None)) / &quot;lib&quot;))
  File &quot;C:\OMERO.server\lib\python\omero\plugins\prefs.py&quot;, line 55, in getprefs

    return omero.java.run(cmd, chdir=dir)
  File &quot;C:\OMERO.server\lib\python\omero\java.py&quot;, line 100, in run
    check_java(command)
  File &quot;C:\OMERO.server\lib\python\omero\java.py&quot;, line 28, in check_java
    raise Exception(&quot;Java could not be found. (Executable=%s)&quot; % command[0])
Exception: Java could not be found. (Executable=java)
</pre></div>

<p>
I also noticed that I could not run java from the command prompt:
</p>

<div class="highlight"><pre>C:\OMERO.server&amp;gt;java -version
&#39;java&#39; is not recognized as an internal or external command,
operable program or batch file.
</pre></div>

<p>
The output of the OMERO diagnostic tool was:
</p>

<div class="highlight"><pre>C:\OMERO.server&amp;gt;bin\omero admin diagnostics

================================================================================

OMERO Diagnostics 5.0.0-ice34-b19
================================================================================


Commands:   java -version                  not found
Commands:   python -V                      2.6.6     (C:\Python26\python.EXE)
Commands:   icegridnode --version          3.4.2     (C:\ZeroC\Ice-3.4.2\bin\x64
\icegridnode.EXE)
Commands:   icegridadmin --version         3.4.2     (C:\ZeroC\Ice-3.4.2\bin\x64
\icegridadmin.EXE)
Commands:   psql --version                 not found

Server:     icegridnode                    not started

Cannot list deployed applications.

Log dir:    C:\OMERO.server\var\log        exists

Log files:  Blitz-0.log                    n/a
Log files:  DropBox.log                    n/a
Log files:  FileServer.log                 n/a
Log files:  Indexer-0.log                  n/a
Log files:  MonitorServer.log              n/a
Log files:  OMEROweb.log                   n/a
Log files:  Processor-0.log                n/a
Log files:  Tables-0.log                   n/a
Log files:  TestDropBox.log                n/a
Log files:  Total size                     0.00 MB
</pre></div>

<p>
(There were some errors on log parsing as well, but I'll save
those for later.) The key thing to note here is that neither Java
nor PostgreSQL are recognized by OMERO.
</p>

<p>
After poking around the web, I came across this old post to the
OMERO listserv:
<a href="http://lists.openmicroscopy.org.uk/pipermail/ome-users/2012-November/003415.html">http://lists.openmicroscopy.org.uk/pipermail/ome-users/2012-November/003415.html</a>. Oscar
solved this problem by installing the 32 bit JDK instead of the 64
bit version. Instead of installing the 32 bit JDK, I searched for
locations of <i>java.exe</i> on my computer and found the binaries
stored in <i>C:\Windows\SysWOW64</i>. This folder is NOT on my Windows
PATH system environment variable, so I added it. <span class="underline">Restarting the
command prompt</span> and running the OMERO diagnostics command like
above now reports that Java is found.
</p>

<p>
As for PostgreSQL, I found this OMERO forum post:
<a href="http://www.openmicroscopy.org/community/viewtopic.php?f=5&t=304">http://www.openmicroscopy.org/community/viewtopic.php?f=5&t=304</a>.
I added <i>C:\Program Files\PostgreSQL\9.3\bin</i> to my PATH system
environment variable, <span class="underline">restarted the command prompt</span>, and saw that
OMERO now recognized Java and PostgreSQL.
</p>

<div class="highlight"><pre>C:\OMERO.server&amp;gt;bin\omero admin diagnostics

================================================================================

OMERO Diagnostics 5.0.0-ice34-b19
================================================================================


Commands:   java -version                  1.7.0     (C:\Windows\SysWOW64\java.E
XE)
Commands:   python -V                      2.6.6     (C:\Python26\python.EXE)
Commands:   icegridnode --version          3.4.2     (C:\ZeroC\Ice-3.4.2\bin\x64
\icegridnode.EXE)
Commands:   icegridadmin --version         3.4.2     (C:\ZeroC\Ice-3.4.2\bin\x64
\icegridadmin.EXE)
Commands:   psql --version                 9.3.3     (C:\Program Files\PostgreSQ
L\9.3\bin\psql.EXE)

Server:     icegridnode                    not started

Cannot list deployed applications.

Log dir:    C:\OMERO.server\var\log        exists

Log files:  Blitz-0.log                    n/a
Log files:  DropBox.log                    n/a
Log files:  FileServer.log                 n/a
Log files:  Indexer-0.log                  n/a
Log files:  MonitorServer.log              n/a
Log files:  OMEROweb.log                   n/a
Log files:  Processor-0.log                n/a
Log files:  Tables-0.log                   n/a
Log files:  TestDropBox.log                n/a
Log files:  Total size                     0.00 MB
</pre></div>
</div>
</div>
<div id="outline-container-sec-3-3-4" class="outline-4">
<h4 id="sec-3-3-4"><span class="section-number-4">3.3.4</span> Generating the SQL initialization script</h4>
<div class="outline-text-4" id="text-3-3-4">
<p>
After fixing the issues with the PATH variable, I successfully
generated the SQL script as instructed in the OMERO documentation.
</p>

<div class="highlight"><pre>C:\OMERO.server&amp;gt;bin\omero db script
Please enter omero.db.version [OMERO5.0]:
Please enter omero.db.patch [0]:
Please enter password for OMERO root user:
Please re-enter password for OMERO root user:
Saving to C:\OMERO.server\OMERO5.0__0.sql
</pre></div>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-3-5" class="outline-4">
<h4 id="sec-3-3-5"><span class="section-number-4">3.3.5</span> Database initialization</h4>
<div class="outline-text-4" id="text-3-3-5">
<p>
This worked just as described in the documentation. Be sure to
enter the username for the user that you created in pgAdmin III,
<b>NOT</b> the default postgres user.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-3-6" class="outline-4">
<h4 id="sec-3-3-6"><span class="section-number-4">3.3.6</span> Error when starting the server and solution</h4>
<div class="outline-text-4" id="text-3-3-6">
<p>
With everything setup, I attempted to start the server and
received this error:
</p>

<div class="highlight"><pre>C:\OMERO.server&amp;gt;bin\omero admin start
Found default value: c:\omero_dist\var\master
Attempting to correct...
Converting from c:\omero_dist to C:\OMERO.server
Changes made: 6
Creating C:\OMERO.server\var\master
Creating C:\OMERO.server\var\registry
No descriptor given. Using etc\grid\windefault.xml
Installing OMERO.master Windows service.
Successfully installed OMERO.master Windows service.
Starting OMERO.master Windows service.
Waiting on startup. Use CTRL-C to exit
.............................
Failed to startup some components after 300 seconds
Calling &quot;stop&quot; on remaining components
OMERO.master service deleted.
Waiting on shutdown. Use CTRL-C to exit
......
</pre></div>

<p>
I made a quick hop over to the relevant section of the
Troubleshooting page at
<a href="https://www.openmicroscopy.org/site/support/omero5/sysadmins/troubleshooting.html#server-fails-to-start">https://www.openmicroscopy.org/site/support/omero5/sysadmins/troubleshooting.html#server-fails-to-start</a>.
</p>

<p>
I verified both that PostgreSQL was configured in the manner
suggested in the documentation and that I had the proper
permissions on <i>C:\OMERO</i>.
</p>

<p>
I then remembered that I changed the password to the PostgreSQL
user that can access the database because I forgot the initial
one :) So I reran the OMERO config commands and successfully
started the server after that.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-3-7" class="outline-4">
<h4 id="sec-3-3-7"><span class="section-number-4">3.3.7</span> Logging in for the first time</h4>
<div class="outline-text-4" id="text-3-3-7">
<p>
To login, I executed the following commands with the proper
password:
</p>

<div class="highlight"><pre>C:\OMERO.server&amp;gt;bin\omero login
Server: [localhost]
Username: [douglass]root
Password:
Created session 1f039a39-b29e-4744-9c95-491407052c11 (root@localhost:4064). Idle
 timeout: 10.0 min. Current group: system
</pre></div>

<p>
I also tested whether I could login with the OMERO.insight
client. This works as well.
</p>

<p>
Note you <b>MUST</b> be logged into the PostgreSQL console as well. I
made this mistake and didn't do it the first time. See my forum
post here:
<a href="https://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7468">https://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7468</a>
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-3-8" class="outline-4">
<h4 id="sec-3-3-8"><span class="section-number-4">3.3.8</span> Increasing the Java Virtual Machine memory</h4>
<div class="outline-text-4" id="text-3-3-8">
<p>
Following the documentation, I next wanted to test whether
increasing the memory available to the Java virtual machine caused
any problems.
</p>

<p>
On line 192 of <i>C:\OMERO.server\etc\grid\templates.xml</i> I changed
<i>-Xmx512M</i> to <i>-Xmx2048M</i>. On line 201, I changed
<i>XX:MaxPermSize=128m</i> to <i>XX:MaxPermSize=256M</i>. I'm not sure
whether the change from a lowercase 'm' to an uppercase 'M'
matters, but I made it anyway according to the documentation.
</p>

<p>
The server failed to restart with these settings. But, by
returning them to their original settings, the server was able to
start. The documentation does state that increasing the memory
size might prevent the server from starting on some test systems,
so I presume that once I have the software installed on the real
server it shouldn't be an issue.
</p>

<p>
Also note that changing <i>-Xmx512M</i> to <i>-Xmx1204M</i>, as well as
increasing <i>XX:MaxPermSize</i> to 256M <b>will</b> work on my machine, so
I don't necessarily have to stick to the recommended values in the
documentation.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-3-3-9" class="outline-4">
<h4 id="sec-3-3-9"><span class="section-number-4">3.3.9</span> OMERO.web and administration</h4>
<div class="outline-text-4" id="text-3-3-9">
<p>
I followed the directions in the documentation exactly to
configure the Django web server and ran it. After receiving a very
long string of outputs from the console, the web server ran. (Be
sure that the OMERO server is running in the background as well,
something that I did not do the first time.)
</p>

<p>
Going to <a href="http://localhost:4080">http://localhost:4080</a> led me to the OMERO.web login
screen.  I noticed that I could not log onto the <b>web</b> server with
the root user account. However, <b>I could log on to the server with
the OMERO.insight client and through the console.</b> This might be a
limitation of the internal Django web server and not an actual
problem with the install.
</p>

<p>
When I would try to log in as root, I'd see the following lines in
my command prompt window:
</p>

<div class="highlight"><pre>[21/Mar/2014 16:15:19] &quot;POST /webclient/login/?url=%2Fwebclient%2F HTTP/1.1&quot; 302
 0
[21/Mar/2014 16:15:19] &quot;GET /webclient/ HTTP/1.1&quot; 302 0
[21/Mar/2014 16:15:19] &quot;GET /webclient/login/?url=%2Fwebclient%2F HTTP/1.1&quot; 200
3358
</pre></div>

<p>
I'm not sure what this means, but for the moment I'm willing to
accept this.
</p>

<p>
<b>UPDATE: April 3, 2014</b>
</p>

<p>
After speaking with the OMERO development team, I learned how to
access the OMERO.web development server from the host machine.
</p>

<p>
I performed the following steps with the OMERO server (but not the
web server) running. Enter the following commands into a command
prompt with administrator privileges:
</p>

<div class="highlight"><pre>bin\omero config set omero.web.session_engine
bin\omero config set omero.web.cache_backend
bin\omero admin restart
</pre></div>

<p>
Now, you should be able to log into the OMERO.web interface with
root or any other user you may have created.
</p>

<hr  />
</div>
</div>
</div>
<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> Summary of software installation</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Before proceeding further, I'd like to highlight several things I
learned about the software installation. I have not yet tried doing
any actual work with the OMERO clients or setup backups and
security. The OMERO server software is just simply running.
</p>

<ul class="org-ul">
<li>Make sure you have the correct versions of the software. <b>Python
2.7 will not work with Ice 3.4.</b>
</li>
<li>Installation of the Python prerequisite packages was the most
difficult part and required some hacking of special environment
variables and Python files that interact with Visual
Studio. These are not related to OMERO itself, but OMERO does
rely on them for some of their functionality. I hope that my
notes will help with their installation on a Windows machine.
</li>
<li>64 bit versions of the various software packages like Java and
Postgre may not be in directories that are already in the Windows
PATH system environment variable. You should add them manually.
</li>
<li>The OMERO team is very active on the help forums and mailing
list. Don't be afraid to use them!
</li>
</ul>

<hr  />
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> OMERO Test Server Maintenance</h2>
<div class="outline-text-2" id="text-4">
<p>
Now that I have the server software up and running, there are a
number of things I want to do first on this test system before
installing OMERO on our dedicated server and putting it into
production. A short list of these things includes:
</p>

<ol class="org-ol">
<li>Understand the concept of programs running in the
foreground/background in Windows
</li>
<li>Deploy OMERO.web on an IIS platform
</li>
<li>Set up routine backups in Windows
</li>
<li>Read up on the system security page found here:
     <a href="http://www.openmicroscopy.org/site/support/omero5/sysadmins/server-security.html">http://www.openmicroscopy.org/site/support/omero5/sysadmins/server-security.html</a>
</li>
<li>Set up OMERO.dropbox
</li>
</ol>

<p>
I will explore these items and post my notes as I do so. Once I feel
comfortable with them, I'll go ahead with the production server
install.
</p>

<hr  />
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Run the OMERO server in the background</h3>
<div class="outline-text-3" id="text-4-1">
<p>
On Windows Server machines, there are two ways to run programs in
the "background." Though I don't fully understand the difference
between the two, some Googling around has led me to believe that
services run very close to the hardware level and are difficult to
create because they require .NET programming or 3rd party
software. Tasks, on the other hand, are easy to schedule using
<b>Windows Task Scheduler</b> and are often the most appropriate choice
when deciding between services and tasks. (See for example this
page:
<a href="http://weblogs.asp.net/jgalloway/archive/2005/10/24/428303.aspx">http://weblogs.asp.net/jgalloway/archive/2005/10/24/428303.aspx</a>)
</p>

<p>
Here's how I managed to start the OMERO server everytime the server
is booted without the need to login as a user in Windows 2008.
</p>

<ol class="org-ol">
<li>Open the Server Manager by either clicking the icon in the
Windows Taskbar or by selecting its shortcut in <i>Start -&gt;
Administrative Tools</i>.
</li>
<li>In the left-most pane you should see a tree of options. The top-most
option is <i>Server Manager</i> with the computer name in
parantheses. Under this level select <i>Configuration -&gt; Task
Scheduler</i>.
</li>
</ol>


<div class="figure">
<p><img src="../../images/ome/omero_taskScheduler_1.JPG" alt="omero_taskScheduler_1.JPG" />
</p>
</div>
<a href="/img/ome/omero_taskScheduler_1.JPG">
  <img class="standard-img" src="/img/ome/omero_taskScheduler_1.JPG" alt="The Windows Task Scheduler screen.">
</a>

<ol class="org-ol">
<li>In the right-most pane, select <i>Create Basic Task&#x2026;</i>.
</li>
<li>Type in a name and description for the task. I named mine
      <i>OMERO.start</i>. Click the Next button.
</li>
<li>Select the <i>When the computer starts</i> radio button to run the
OMERO batch script when the computer boots. Click the Next
button.
</li>
<li>Select the <i>Start a program</i> radio button and click Next.
</li>
<li>In the text box, enter the full path and file name of the batch
file, <i>C:\OMERO.server\bin\omero.bat</i>. In the <i>Add arguments
(optional)</i> text box, enter <i>admin start</i>. In the <i>Start in
(optional)</i> text box, enter <i>C:\OMERO.server\bin</i>. Click next.
</li>
</ol>


<div class="figure">
<p><img src="../../images/ome/omero_taskScheduler_2.JPG" alt="omero_taskScheduler_2.JPG" />
</p>
</div>
<a href="/img/ome/omero_taskScheduler_2.JPG">
  <img class="standard-img" src="/img/ome/omero_taskScheduler_2.JPG" alt="Settings for selecting the OMERO batch script.">
</a>

<ol class="org-ol">
<li>In the final pane, check the <i>Open the Properties dialog for
this task when I click Finish</i> box and click the Finish button.
</li>
<li>In the Properties window under the <i>General</i> tab, check the <i>Run
whether user is logged on or not</i> radio button and check <i>Run
with highest privileges</i>.
</li>
</ol>

<p>
You can now click the OK button and the OMERO server should startup
at run time.
</p>

<p>
Note that earlier I discovered that I needed postgreSQL to be
running to startup the OMERO server, but I've now discovered that
this is not true. I don't know why there is a difference, but upon
rebooting, the OMERO server started without problems. I could log
on with the OMERO.insight client did not have to schedule a
postgreSQL task.
</p>

<p>
What is also interesting is that I can see a running service named
<i>postgresql-x64-9.3</i> in the Windows Task Manager, so perhaps
PostgreSQL runs in the background after a full reboot.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Deploying OMERO.web on IIS</h3>
<div class="outline-text-3" id="text-4-2">
<p>
IIS was already setup on my Windows 2008 machine. It seems
relatively easy to add if it's not on your machine, however.
</p>

<p>
The OMERO.web setup documentation is found here:
<a href="https://www.openmicroscopy.org/site/support/omero5/sysadmins/windows/install-web.html">https://www.openmicroscopy.org/site/support/omero5/sysadmins/windows/install-web.html</a>. I
first set the web application server to the recommended FastCGI TCP
by entering the following command in the command prompt with
administrator rights:
</p>

<div class="highlight"><pre>bin\omero config set omero.web.application_server &quot;fastcgi-tcp&quot;
</pre></div>

<p>
I next verified that ISAPI was enabled in IIS by going into the
Server Manager application, selecting <i>Roles -&gt; Web Server (IIS)</i>
in the left-hand pane, then scrolling down to <i>Role Services</i> in
the Web Server (IIS) right-hand pane. On my system, ISAPI
Extensions and ISAPI Filters are already installed.
</p>


<div class="figure">
<p><img src="../../images/ome/omero_webServer.JPG" alt="omero_webServer.JPG" />
</p>
</div>
<a href="/img/ome/omero_webServer.JPG">
  <img class="standard-img" src="/img/ome/omero_webServer.JPG" alt="Screenshot of the Server Manager screen showing installed ISAPI Extensions and Filters.">
</a>

<p>
Continuing through the steps in the documentation, I next navigated
to <a href="http://code.google.com/p/isapi-wsgi/downloads/list">http://code.google.com/p/isapi-wsgi/downloads/list</a> and
downloaded <i>isapi_wsgi-0.4.2.win32.exe</i>. I ran the executable but
it reported that no Python install was found in the registry.
</p>

<p>
After reading the Google Code ISAPI-WSGI page
(<a href="http://code.google.com/p/isapi-wsgi/wiki/InstallationInstructions">http://code.google.com/p/isapi-wsgi/wiki/InstallationInstructions</a>)
I next tried to install isapi_wsgi through pip instead. In the
command prompt I executed the following commands:
</p>

<div class="highlight"><pre>cd C:\Python26\Scripts
easy_install isapi_wsgi
</pre></div>

<p>
This seemed to successfully install the ISAPI WSGI package onto my
system.
</p>

<p>
The next step involved enabling 32-bit applications in IIS, since
I'm running a 64 bit version of Windows Server 2008. To do this, I
navigated to <i>Start -&gt; Administrative Tools -&gt; Internet Information
Services (IIS) Manager</i>. In the left-hand pane, I selected my
server machine, then clicked <i>Application Pools</i>. In the right-hand
pane, I right-clicked <i>DefaultAppPool</i> and selected <i>Advanced
Settings&#x2026;</i>. Then, I set the <i>Enable 32-Bit Applications</i> flag to
<i>True</i>.
</p>


<div class="figure">
<p><img src="../../images/ome/omero_webServer_2.JPG" alt="omero_webServer_2.JPG" />
</p>
</div>
<a href="/img/ome/omero_webServer_2.JPG">
  <img class="standard-img" src="/img/ome/omero_webServer_2.JPG" alt="Screenshot showing where you can enable 32-bit applications in IIS.">
</a>

<p>
Finally, I entered the final three commands recommended in the
documentation:
</p>

<div class="highlight"><pre>C:\omero_dist&amp;gt;bin\omero config set omero.web.session_engine &quot;django.contrib.sessions.backends.cache&quot;

C:\omero_dist&amp;gt;bin\omero config set omero.web.cache_backend &quot;file://C:/windows/temp/&quot;

C:\omero_dist&amp;gt;bin\omero web iis
</pre></div>

<p>
After struggling a bit to understand why I could not access
OMERO.web from my browser, I realized I skipped a step. I had to
turn on IIS 6 backwards compatibility.
</p>

<p>
To do this, I navigated to the Server Manager and selected <i>Roles</i>
in the left-hand pane. In the right-hand pane, I scrolled down to
the Web Server (IIS) section and clicked <i>Add Role Services</i> on the
right. From here I installed IIS 6 WMI Compatibility and IIS 6
Scripting Tools. (Note that IIS 6 Metabase Compatibility was
already installed.)
</p>

<p>
OMERO.web still would not start after this. I also tried accessing
the web interface by navigating to <a href="http://localhost/omero">http://localhost/omero</a> but this
returned an "Error 500-Internal server error." With little other
idea what was happening, I turned to the forums and eventually
found a solution with the help of someone else having similar
problems. The two forum topics are below. I also found a related
thread on the listserv which I believe is related and included it
below:
</p>

<ol class="org-ol">
<li><a href="http://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7476&p=13822#p13822">http://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7476&p=13822#p13822</a>
</li>
<li><a href="http://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7486">http://www.openmicroscopy.org/community/viewtopic.php?f=5&t=7486</a>
</li>
<li><a href="http://lists.openmicroscopy.org.uk/pipermail/ome-users/2014-April/004322.html">http://lists.openmicroscopy.org.uk/pipermail/ome-users/2014-April/004322.html</a>
</li>
</ol>

<p>
The solution to the problem has two parts: clearing the troublesome
config variables and disabling 32 bit support in IIS. First, I
followed the steps that the OMERO team recommended to unset the two
configuration variables that were causing problems with logging
into the development server.
</p>

<div class="highlight"><pre>bin\omero config set omero.web.session_engine
bin\omero config set omero.web.cache_backend
bin\omero admin restart
</pre></div>

<p>
Next, I disabled 32-bit support in the IIS Manager
window. Specifically, I went to Start -&gt; Administrator Tools -&gt;
Internet Information Services (IIS) Manager. I clicked my server in
the left-hand pane, then selected "Application Pools" beneath it. I
right-clicked DefaultAppPool and selected "Advanced Settings&#x2026;"
from the menu. In the new menu, I disabled the 32 bit support. This
is in contradiction to the OMERO server documentation as of April
4, 2014, but since they're in the process of updating their
documentation with the release of OMERO 5.0, it might have already
been addressed.
</p>

<p>
This allowed me to access the web server with my browser without
having to restart IIS, OMERO, or even run the <i>bin\omero web start</i>
command. The address of the server is <i>localhost\/omero</i>. I can
also now access the OMERO.web interface from other computers on my
network by going to a browser and entering my server's IP address
followed by <i>\/omero</i>.
</p>

<hr  />
</div>

<div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1"><span class="section-number-4">4.2.1</span> Summary of IIS web deployment</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
To deploy OMERO.web on April 4, 2014 using the same software
versions that I'm using, you will have to clear the
<i>omero.web.session_engine</i> and <i>omero.web.cache_backend</i>
configuration variables and disable 32 bit support in Windows IIS
manager. With these two changes, the OMERO server documenation
should lead to a working OMERO server.
</p>

<hr  />
</div>
</div>
</div>
<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Setting up routine backups</h3>
<div class="outline-text-3" id="text-4-3">
<p>
<i>Note: Windows Task Scheduler is the Windows equivalent to Unix's
cron, which should be the tool to use to routinely backup the</i>
<i>various parts of OMERO.</i>
</p>

<p>
The OMERO documentation recommends frequent backups of 1) the
PostgreSQL database and 2) the OMERO binary data. To backup the
PostgreSQL database, there is a pre-made Windows batch file for
doing just this at the PostgreSQL Wiki found here (though I found
that it should be modified):
<a href="https://wiki.postgresql.org/wiki/Automated_Backup_on_Windows">https://wiki.postgresql.org/wiki/Automated_Backup_on_Windows</a>. This
batch file can be run atuomatically using Windows Task Scheduler.
</p>

<p>
I first created a new directory for backups in <i>C:\Program
Files\PostgreSQL\9.3\backup\</i>. In this directory, I created a batch
file called <i>OMERO_backup.bat</i> that contained the following:
</p>

<div class="highlight"><pre>@echo off
echo Date is %date%

set DB_NAME=omero_database
set BACKUP_FILE=%DB_NAME%_%date%.pg_dump
echo backup file name is %BACKUP_FILE%
SET PGPASSWORD=&amp;lt;PASSWORD&amp;gt;
echo on
..\bin\pg_dump -i -h localhost -p 5432 -U &amp;lt;DBUSER&amp;gt; -F c -f %BACKUP_FILE% %DB_NAME%

@echo off
set PGPASSWORD=
</pre></div>

<p>
Obviously, you should replace &lt;PASSWORD&gt; and &lt;DBUSER&gt; with the
appropriate information, which in this case is the user you chose
as the owner of omero_database. Also, make sure that only
administrator's have access to the folder that contains this batch
file since the PostgreSQL password is saved as plain text.
</p>

<p>
(In case you're wondering what the pg_dump command does, or about
PostgreSQL backups in general, there is a very nice and clear
explanation here:
<a href="http://www.postgresql.org/docs/9.1/interactive/backup.html">http://www.postgresql.org/docs/9.1/interactive/backup.html</a>)
</p>

<p>
Finally, this batch file can be set to run daily using Windows Task
Scheduler in a manner similar to the one used to start OMERO at the
server startup.
</p>

<p>
Backing up the OMERO binary data store comes down to deciding on
proper backup software. The documentation recommends using the open
source rdiff-backup, but the website for this software suggests
that it's not well-tested in Windows. Despite this, I tried out the
Windows binaries for rdiff-backup version 1.2.8 anyway (they are
found here: <a href="http://www.nongnu.org/rdiff-backup/">http://www.nongnu.org/rdiff-backup/</a>). I did this
because we've had issues restoring Windows backup compressed files
in the past. As a result, my lab switched to using SyncBackFree,
but this doesn't run on a Windows Server machine. In the absence of
other easy options, I decided to stick with rdiff-backup.
</p>

<p>
After downloading the rdiff-backup zip file, I unzipped it and
placed the executable in <i>C:\Windows\</i>, though any directory in the
PATH environement variable would work. I then created a batch file
called <i>OMERO_binary_backup.bat</i> that contained the following
lines:
</p>

<div class="highlight"><pre>@echo off
SET FROM=C:\OMERO
SET TO=N:\OMERO_backup

rdiff-backup %FROM% %TO%
</pre></div>

<p>
I scheduled this batch file to run daily as well.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4"><span class="section-number-3">4.4</span> Notes on security</h3>
<div class="outline-text-3" id="text-4-4">
<p>
I read through the security page at
<a href="http://www.openmicroscopy.org/site/support/omero5/sysadmins/server-security.html">http://www.openmicroscopy.org/site/support/omero5/sysadmins/server-security.html</a>
to get an idea about security in OMERO.
</p>

<p>
It would seem that I have a relatively simple job at manging
security on this system since I am not hosting the binary
repository on a different server than the OMERO install. If instead
the binaries were on a different server, <b>or if I was using LDAP to
synchornize user accounts in multiple programs including OMERO</b>,
then I should take additional measures to ensure that the LDAP
communications were secure/encrypted.
</p>

<p>
I found good introductory resources explaining SSL (the mechanism
used for signal encryption) and LDAP (the uniform language for data
access across different clients and servers) at these two sites,
respecitvely:
</p>

<ol class="org-ol">
<li><a href="http://www.webopedia.com/TERM/S/SSL.html">http://www.webopedia.com/TERM/S/SSL.html</a>
</li>
<li><a href="http://www.gracion.com/server/whatldap.html">http://www.gracion.com/server/whatldap.html</a>
</li>
</ol>

<p>
In addition, I read up on packet filtering. Below, I've provided
links to useful resources. The first is an introductory explanation
of the concept of packet filtering, followed by the man-page for
iptables (only for Linux, but still informative). The last resource
is the Windows Server 2008 documenation for adding packet filters
to your server:
</p>

<ol class="org-ol">
<li><a href="http://searchnetworking.techtarget.com/definition/packet-filtering">http://searchnetworking.techtarget.com/definition/packet-filtering</a>
</li>
<li><a href="http://ipset.netfilter.org/iptables.man.html">http://ipset.netfilter.org/iptables.man.html</a>
</li>
<li><a href="http://technet.microsoft.com/en-us/library/cc732746%28v=ws.10%29.aspx">http://technet.microsoft.com/en-us/library/cc732746%28v=ws.10%29.aspx</a>
</li>
</ol>

<p>
On the Windows doc page, it recommends using either static packet
filters or Windows Firewall, but not both. I discovered that I can
add rules for incoming ports in Windows Firewall instead of
performing static packet filtering.
</p>

<p>
Finally, if need be, I can restrict clients' rights to turn off SSL
encryption for non-password-related communications with the OMERO
server. Clients might do this to speed up their data access rate
with the server. Instructions on how to do this are listed in the
OMERO security docs on the page mentioned above.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5"><span class="section-number-3">4.5</span> DropBox</h3>
<div class="outline-text-3" id="text-4-5">
<p>
OMERO.dropbox is described here:
<a href="http://www.openmicroscopy.org/site/support/omero5/sysadmins/dropbox.html">http://www.openmicroscopy.org/site/support/omero5/sysadmins/dropbox.html</a>
</p>

<p>
It doesn't appear too difficult to setup. I only need to add a few
folders to <i>C:\OMERO\DropBox</i> and set a few parameters in
<i>etc\grid\templates.xml</i>. I'll wait to set this up on the actual
server.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6"><span class="section-number-3">4.6</span> Summary of Test Server Maintenance</h3>
<div class="outline-text-3" id="text-4-6">
<p>
Most of my time went into deploying OMERO.web onto IIS on the test
server. This was because of a bug, either in the software or
documentation, that asked that we enable 32-bit compatibility when
in fact it prevented OMERO.web from displaying in a web browser.
</p>

<p>
The other tasks, like setting recurring backups, are relatively
simple, but still very important.
</p>

<hr  />
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> OMERO Server Installation</h2>
<div class="outline-text-2" id="text-5">
<p>
At this point I've been able to run OMERO successfully in Windows
Server 2008, access the server from other computers on our network,
and play around inside OMERO.insight as the root user.
</p>

<p>
I'm now ready to install the software onto our full-time server.
</p>

<hr  />
</div>

<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> Server Specs</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>Transtec Calleo 4260
</li>
<li>2x Intel Xeon E5-2620v2 processors
</li>
<li>14.5 TB total storage space
</li>
<li>64 GB memory
</li>
<li>Windows 2012 R2 Server 64 bit
</li>
</ul>


<p>
The biggest difference with this machine is that it will be running
Windows 2012 Server, not Windows 2008 Server.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> Pre-installation</h3>
<div class="outline-text-3" id="text-5-2">
</div><div id="outline-container-sec-5-2-1" class="outline-4">
<h4 id="sec-5-2-1"><span class="section-number-4">5.2.1</span> Turn off Windows Installer RDS Compatibility</h4>
<div class="outline-text-4" id="text-5-2-1">
<p>
Before installing anything, I first had to turn off Windows
Installer compatibility with remote desktop. This is because
Windows uses a utility that queues installations in case there are
multiple administrators working on a system. Unfortunately,
programs like the Java SDK that call multiple installers will hang
during installation on a remote desktop session due to the
queuing.
</p>

<p>
I turned off RDS compatibility by entering <i>Edit group policy</i> in
the Start menu search bar. Then, in the window that appears, I
navigated to <i>Computer Configuration\Administrative
Templates\Windows Components\Remote Desktop Services\Remote</i>
<i>Desktop Session Host\Application Compatibility\Turn off Windows
Installer RDS Compatibility</i>
</p>

<p>
After double-clicking <i>Turn off Windows Installer RDS
Compatibility</i>, a new window popped up in which I clicked on the
<i>Enabled</i> radio button.
</p>

<p>
<b>ATTENTION:</b> You may want to re-enable this when you're done in
case you have multiple administrators. See
<a href="http://www.gearbytes.com/2010/11/looping-windows-installer-coordinator/">http://www.gearbytes.com/2010/11/looping-windows-installer-coordinator/</a>
for more information.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> Software</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Similar to my test install, I installed the following software in
the order listed below.
</p>

<ul class="org-ul">
<li>Java SE Development Kit 7u51 (64-bit)
</li>
<li>Python 2.6.6 (64-bit)
<ul class="org-ul">
<li>Python for Windows Build 218
</li>
<li>pip 1.5.4
</li>
<li>*Pillow 2.4.0
</li>
<li>Numpy 1.8.0
</li>
<li>Scipy-0.14.0b1
</li>
<li>matplotlib 1.3.1
</li>
<li>numexpr 2.1
</li>
<li>Cython 0.20.1
</li>
<li>HDF4 1.8.12
</li>
<li>Pytables 3.1
</li>
</ul>
</li>
<li>Ice 3.4.2
</li>
<li>PostgreSQL 9.3.3
</li>

<li>Denotes a difference from the Windows Server 2008 install.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> Differences from test server installation</h3>
<div class="outline-text-3" id="text-5-4">
<p>
There were the following differences in installing software between
the Windows Server 2012 and Windows Server 2008 machine:
</p>

<ol class="org-ol">
<li>The Python Pillow package installs using the command
<i>easy_install Pillow</i> in Windows Server 2012. It installed
Pillow 2.4.0 for Python 2.6 (64-bit).
</li>
<li>Microsoft Visual Studio 2013 is installed on this new machine,
so I set the environment variable <i>set
VS90COMNTOOLS=%VS120COMNTOOLS%</i>.
</li>
<li>I installed OMERO.server 5.0.1, not 5.0.0.
</li>
<li>I had to add <i>C:\Program Files\PostgreSQL\9.3\bin</i> to my PATH
system environment variable to get the <i>bin\omero admin
diagnostics</i> command to recognize psql.
</li>
<li>When scheduling a Windows task to automatically run the OMERO
server at startup, I ensured that the task <i>DID NOT</i> stop if it
ran for longer than three days.
</li>
<li>I placed rdiff-backup.exe in <i>C:\Windows\SysWOW64</i>. (See this
forum topic:
<a href="http://stackoverflow.com/questions/16760449/py2exe-in-c-windows-system32-on-64-bit-windows">http://stackoverflow.com/questions/16760449/py2exe-in-c-windows-system32-on-64-bit-windows</a>)
</li>
<li>I'm backing up the OMERO repository and SQL database to two
different directories, <i>C:\OMERO_backup</i> and
<i>C:\OMERO_SQL_backup</i>.
</li>
<li>I created two batch files for server management that are run
daily.
<dl class="org-dl">
<dt> OMERO_backup.bat </dt><dd>Backup the SQL data base using PostgreSQL
dumps
</dd>
<dt> OMERO_rdiff_backup.bat </dt><dd>Backup the repository and SQL dump
</dd>
</dl>
</li>
<li><i>omero admin start</i> is scheduled to run everytime the server
starts.
</li>
<li>I opened ports 4064 and 4063 in the firewall to incoming TCP
traffic. Before I did this, I could not remotely connect to the
server.
</li>
<li><b>IMPORTANT</b> Be sure not to schedule the SQL dumps and the
rdiff-backup of the SQL dumps at the same time. Otherwise, you
may not back up the latest file. You'll want to schedule
rdiff-backups slight after the SQL dump.
</li>
</ol>

<hr  />
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> OMERO Server Administration</h2>
<div class="outline-text-2" id="text-6">
<p>
This section is not meant to be a walkthrough or tutorial, but
merely a place to keep notes on how I've administered our server.
</p>

<hr  />
</div>

<div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Group and User Creation</h3>
<div class="outline-text-3" id="text-6-1">
<p>
I created a group for our lab that had "Private" permissions. In
the future, once we're done testing the software, we'll probably
upgrade the permissions to "Read-only."
</p>

<p>
According to the OMERO documentation, administrators can't severe
Read-only permissions on data if they're initially set to
Read-only. However, a group can be promoted to read-only from
private. Additionally, a group can be switched between Read-only
and "Read-annotate" quite easily.
</p>

<hr  />
</div>
</div>
<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> Requirements for OMERO.movie</h3>
<div class="outline-text-3" id="text-6-2">
<p>
The OMERO.movie script generates a movie from a file containing a
z-stack, time series, or multiple color channels. However, it did
not work without installing mencoder first. To do this, I simply
downloaded and unpacked the latest <b>mplayer</b> software for
Windows. I added the directory containing mencoder.exe to my system
<b>PATH</b> variable and restarted the OMERO server. After this, I could
run the OMERO.movie script.
</p>

<p>
<a href="http://www.openmicroscopy.org/site/support/omero4/sysadmins/omeromovie.html">http://www.openmicroscopy.org/site/support/omero4/sysadmins/omeromovie.html</a>
</p>
</div>
</div>
</div>
